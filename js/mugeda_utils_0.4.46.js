MugedaHelper={};function G(a){return document.getElementById(a)}function E(a,b,c){b||(b="load");c||(c=window);if(b==="load"&&c.document.readyState==="complete")return setTimeout(a);c.attachEvent?c.attachEvent("on"+b,a):c.addEventListener(b,a,false)}function json(a){try{return eval("("+a+")")}catch(b){return null}}function _188(a){if(!a||typeof a=="string")return a;var b="",c;for(c in a)b+="&"+c+"="+encodeURIComponent(a[c]);b&&(b=b.substr(1));return b}
function ajax(a){var b=/POST/i.test(a.type),c=a.data||"",d=a.dataType,f=a.url||location.href,e=/\?/.test(f)?"&":"?",g=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Msxml2.XMLHTTP")||new ActiveXObject("Microsoft.XMLHTTP");g.onreadystatechange=function(c){if(g.readyState==4)g.status==200?(c=g.responseText,d=="json"&&(c=json(c)),(b=a.success)&&b(c)):a.error&&a.error(g.status,g)};if(typeof c=="object"){var j=[],h;for(h in c)j.push(encodeURIComponent(h)+"="+encodeURIComponent(c[h]));c=j.join("&")}g.open(b?
"POST":"GET",f+(b?"":(c?e:"")+c+(a.cache?"":(!c&&e=="?"?"?":"&")+(a.cache_ok?"":"_="+(new Date).getTime()))),a.async===false?false:true);b&&g.setRequestHeader("Content-Type","application/x-www-form-urlencoded");g.send(c);return g}
var ajaxHelper=function(a){return new Promise(function(b,c){a=a||{};a.method=a.method||"GET";a.type=(a.type||"text").toLowerCase();a.success=a.success||function(){};a.error=a.error||function(){};a.cache_ok=a.cache_ok||false;var d={status:-5,desc:"Empty url"};a.url=a.url||(a.error(d),c(d),"");a.mode=a.mode||null;if(a.type=="jsonp"){var f=(new Date).getTime()+""+Math.random(),f=f.replace(".","");a.jsonp_callback=a.jsonp_callback||"callback_"+f;window.hashOptions=window.hashOptions||{};window.hashOptions[f]=
a;window.hashOptions[""]=a;a.cache_ok||(a.url+=a.url.indexOf("?")>-1?"&":"?",a.url+="_mats="+f,a.url+="&callback="+a.jsonp_callback);if(a.mode&&a.mode=="postMessage"){var e;try{e=window.Mugine.Utils.Browser.getWeixinServerHost()}catch(g){e=(location.protocol||"http:")+"//weika.mugeda.com"}var j=e+"/server/postMessage.html?version=5",h="postMessage_"+f;window[h]=function(c,e,d){var f={};(d||"").split("\r\n").forEach(function(a){a=a.split(":");a.length===2&&(f[a[0].trim()]=a[1].trim())});a.success(c,
f);b(c);delete window[h]};d={url:a.url,form:a.form||{},mats:f,callbackName:h,dataType:a.postMessageType||"JSONP",isPost:a.isPost||false,responseType:a.responseType,contentType:a.contentType};if(!window._POSTMESSAGE){window._POSTMESSAGE=[];window.addEventListener("message",function(a){if(a.data){if(a.data.callbackName&&window[a.data.callbackName])window[a.data.callbackName](a.data.res,a.data.mats,a.data.header)}else console.log("postMessage\u8bf7\u6c42\u5931\u8d25")});var i=document.getElementsByTagName("head")[0],
n=document.createElement("iframe");n.id=f;n.src=j;i.appendChild(n);n.onload=function(){var a=n.contentWindow;window._POSTMESSAGE.forEach(function(b){a.postMessage(b,e)});window._POSTMESSAGE=a};n.onerror=function(){alert("postMessage\u6a21\u5757\u52a0\u8f7d\u5931\u8d25\u3002")}}Array.isArray(window._POSTMESSAGE)?window._POSTMESSAGE.push(d):window._POSTMESSAGE.postMessage(d,e)}else a.mode&&a.mode=="iframe"?(i=document.getElementsByTagName("head")[0],h=a.jsonp_callback+"_"+f,window[h]=function(c){a.success(c);
b(c);i.removeChild(document.getElementById(f));delete window[h]},n=document.createElement("iframe"),i.appendChild(n),j=n.contentDocument,n.id=f,j.open(),j.write('<html><head><title>_iframe</title></head><body><script>window["'+a.jsonp_callback+'"] = function (data) {window.parent["'+h+'"](data)}<\/script><script type="text/javascript" src="'+a.url+'"><\/script></body></html>'),j.close()):(window[a.jsonp_callback]=function(a){var c=window.hashOptions[a._mats||""];c.success(a);b(a);delete window[c.jsonp_callback]},
i=document.getElementsByTagName("head")[0],j=document.createElement("script"),j.type="text/javascript",j.src=a.url,j._mats=f,j.onload=function(){},j.onerror=function(){var b={status:-2,desc:"Failed to load the url: "+a.url};window.hashOptions[this._mats||""].error(b);c(b)},i.appendChild(j))}else if(a.type=="fetch"&&window.fetch)try{var t={method:a.method||"GET",credentials:a.credentials||"include"};if(a.data)t.body=a.data;fetch(a.url,t).then(function(e){e.status!==200?(e={status:e.status,desc:"Error in fetching data "+
e.statusText},a.error&&a.error(e),c(e)):e.json().then(function(c){a.success(c);b(c)})})}catch(l){d={status:-1,desc:"Error in fetching data "+l.toString()},a.error&&a.error(d),c(d)}else{var k;window.XMLHttpRequest?k=new XMLHttpRequest:(d={status:-3,desc:"Platform not supported"},a.error(d),c(d));k.withCredentials=a.withCredentials||true;k.onreadystatechange=function(){if(k.readyState==4)if(k.status==200){var e="ok";if(a.type=="json")try{var d=JSON.parse(k.responseText);a.success(d);b(d)}catch(f){e=
f.toString(),e={status:-6,desc:"Error in parsing JSON ("+e+")"},a.error(e),c(e)}else a.type=="data"||a.type=="buffer"?(a.success(k.response),b(k.response)):a.type=="text"&&(a.success(k.responseText),b(k.responseText))}else e={status:k.status,desc:"Error in fetching data (code "+k.status+")"},a.error(e),c(e)};if(a.type=="data")k.responseType="blob";else if(a.type=="buffer")k.responseType="arraybuffer";k.open(a.method,a.url,true);for(j in a.headers||[])k.setRequestHeader(j,a.headers[j]);a.formData?
k.send(a.formData):k.send()}})};MugedaHelper.imgElementToBase64=function(a){var b=document.createElement("canvas");b.width=a.width;b.height=a.height;b.getContext("2d").drawImage(a,0,0,a.width,a.height);return b.toDataURL("image/png",0.5)};MugedaHelper.uploadImageBase64=function(a){MugedaHelper.uploadImage({type:"base64",imgData:a})};
MugedaHelper.uploadImage=function(a){if(a.type==="base64")if(a.imgData)var b=/data:image\/(.*);/.test(a.imgData)&&window.RegExp.$1,c=a.imgData.replace(/data:image\/(.*);base64,/,"");else if(a.audioData)b=/data:audio\/(.*);/.test(a.audioData)&&window.RegExp.$1,c=a.audioData.replace(/data:audio\/(.*);base64,/,"");else return Promise.reject({status:20004,desc:"\u4e0a\u4f20\u6570\u636e\u4e3a\u7a7a"});else if(a.type==="url"){var d=a.url;if(!d)return Promise.reject({status:20004,desc:"\u4e0a\u4f20\u56fe\u7247\u5730\u5740\u4e3a\u7a7a"})}else return Promise.reject({status:20004,
desc:"\u4e0d\u652f\u6301\u7684\u4e0a\u4f20\u7c7b\u578b"});var f=/token=(.*)(?:;|$)/.test(document.cookie)&&window.RegExp.$1||"",e=window.Mugine.Utils.Browser.getWeixinServerHost();if(window._mrmcp&&window._mrmcp.creative_id)var g=window._mrmcp.creative_id;var j="";window._mrmcp&&window._mrmcp.customer_visitor_tailor_uid&&(j=window._mrmcp.customer_visitor_tailor_uid);f="urid="+(g?"&crid="+g:"")+"&login=true&token="+f+(j?"&customer_visitor_tailor_uid="+j:"");a.type==="base64"?(f+="&imgdata="+encodeURIComponent(c),
f+="&type="+b):a.type==="url"&&(f+="&url="+d);return ajaxHelper({method:"POST",url:e+"/server/app_asset.php/u",type:"json",withCredentials:true,headers:{"Content-Type":"application/x-www-form-urlencoded"},formData:f})};
function isMobile(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)?true:false}function fo(a){var b=0,c=0;do b+=a.offsetLeft||0,c+=a.offsetTop||0;while(a=a.offsetParent);return{x:b,y:c}}function fe(a){a=a||event;return{x:a.pageX||a.x,y:a.pageY||a.y}}
function fc(a){a&&a.stopPropagation?a.stopPropagation():event.cancelBubble=true}function getClass(a,b){for(var c=RegExp("(^|\\s*)"+a+"(\\s*|$)"),d=b?document.getElementsByTagName(b):document.getElementsByTagName("*")||document.all,f=[],e=0,g=d.length;e<g;e++)c.test(d[e].className)&&f.push(d[e]);return f}
var setCookie=function(a,b,c){var d=new Date,f=window.location.host.split("."),e=f.length,g="",g=e>=2?"."+f[e-2]+"."+f[e-1]:".mugeda.com";d.setDate(d.getDate()+c);document.cookie=a+"="+escape(b)+(c==null?"":";expires="+d.toGMTString())+"; domain="+g+"; path=/"},getCookie=function(a){if(document.cookie.length>0){var b=document.cookie.indexOf(a+"=");if(b!=-1){b=b+a.length+1;c_end=document.cookie.indexOf(";",b);if(c_end==-1)c_end=document.cookie.length;return unescape(document.cookie.substring(b,c_end))}}return""},
getUrlParam=function(a){var b=window.location.href.split("?");if(b.length<=1)return"";for(var b=b[1].split("&"),c=0;c<b.length;c++){var d=b[c].split("=");if(a==d[0])return d[1]}},getMsuid=function(a){var b=localStorage.getItem("msuid");if(!b){for(var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),c=Number(+new Date).toString(36),d=0,f="",e=b.length;d<32;d++)f+=b[Math.floor(Math.random()*e)];b=c+f.toLowerCase();localStorage.setItem("msuid",b)}c=new URLSearchParams(location.search);
c.has("msuid")&&(b=c.get("msuid"));window.__MSUID=b;return!a||typeof a!="function"?b:a(b)},getOwnerid=function(){return getUrlParam("owner_id")?(window.__OWNERID=getUrlParam("owner_id"),getUrlParam("owner_id")):""};if(window.Mugeda)Mugeda.getMsuid=getMsuid;JSON.clone=function(a){return JSON.parse(JSON.stringify(a))};function getElementOffset(a){for(var b=0,c=0;a&&a.tagName!="BODY";)b+=a.offsetTop,c+=a.offsetLeft,a=a.offsetParent;return{top:b,left:c}}Mugeda=window.Mugeda||{};
window._mrmcp=window._mrmcp||{};var creative_path=_mrmcp.creative_path||"";Array.isArray(creative_path)&&(creative_path=creative_path[0]);creative_path.length&&creative_path[creative_path.length-1]!="/"&&(creative_path+="/");var close_img_url=_mrmcp.previewMode?"/client/close_button.png":creative_path+"images/close_button.png",MugedaTools=window.MugedaTools=window.MugedaTools||{};
MugedaTools.message=function(){var a,b=[],c={},d=function(){var a=window.getComputedStyle(document.documentElement,""),a=(Array.prototype.slice.call(a).join("").match(/-(moz|webkit|ms)-/)||["",""])[1];return{dom:"WebKit|Moz|MS".match(RegExp("("+a+")","i"))[1],lowercase:a,css:"-"+a+"-",js:a[0].toUpperCase()+a.substr(1)}}();return{show:function(f,e){e=e||{};if(!a){var g=document.createElement("div");g.className="mugeda_mask";var j=e.parent||document.body,h=e.hideShade,i=e.center,n=e.clickable,t=g.appendChild(document.createElement("div")),
l=t.appendChild(document.createElement("div")),k=t.appendChild(document.createElement("div"));g.style.cssText=n?"text-align: center; display: block; position: absolute;left: 50%; top: 50%; transform: translate(-50%, -50%);":"position:fixed;left:0;right:0;top:0;bottom:0;text-align:center;line-height:"+(e.parent?j.offsetHeight:document.body.clientHeight||document.documentElement.clientHeight)+"px";t.style.cssText="padding-top:10px; line-height:30px;display:inline-block;padding:8px; background-color:rgba(0,0,0,"+
(h?0:0.6)+");border-radius:4px;"+(i?"position:relative;top:32px;":"");t.align="center";l.style.cssText="width: 24px; height: 24px; display: block; border-radius: 50%; border-left: 2px solid #F36523; border-top: 2px solid #F36523; border-right: 2px solid white; border-bottom: 2px solid white; margin: 16px;";k.style.cssText='text-align:center;color:#fff;font:normal 12px "microsoft yahei";';k.innerHTML=f||"";a=j.appendChild(g);h="from {"+d.css+"transform:rotate( 0deg ) }to {"+d.css+"transform:rotate( 360deg ) }";
g=document.createElement("style");document.head.appendChild(g);g=g.sheet;j="spin_"+(new Date).getTime();h="@"+d.css+"keyframes "+j+"{ "+h+"}";if(b.length)i=b.pop().name,n=c[i],delete c[i],g.deleteRule(n),g.insertRule(h,n),c[j]=n;else{i=g.cssRules.length;try{g.insertRule(h,i)}catch(x){}c[j]=i}l.style.cssText+=d.css+"animation:"+j+" 1200ms linear infinite;"}},close:function(){a&&(a.parentNode.removeChild(a),a=null)},showTikuEnd:function(b,c){var d='<div class="result" style="display: flex;flex-direction: column;position: fixed; top: 0; left: 0; width: 100%; height: 100%; background:#F5F5F5; box-sizing: border-box; align-items: center; text-align: center; justify-content: center;">';
d+='    <div class="layout">';d+='        <div class="title1" style="font-size: 30px; color: #333;">'+b["\u8003\u8bd5\u540d\u79f0"]+"</div>";d+='        <div class="title2" style="margin-top: 14px; font-size: 14px; color: #666;">\u4f7f\u7528\u65f6\u95f4 <span class="p_time">'+b["\u5b8c\u6210\u7b54\u5377\u65f6\u957f"]+"</span></div>";d+='        <div class="c1" style="margin-top: 57px; background: rgba(64,158,255,0.10); border-radius: 50%;">';d+='            <div class="c2" style="display:inline-block; margin: 15px; box-sizing: border-box; background: rgba(64,158,255,0.30); border-radius: 50%;">';
d+='                <div class="c3" style="display:inline-flex; width: 170px; height: 170px; margin: 15px; background-image: linear-gradient(-180deg, #8CC5FF 0%, #1393FF 100%); border-radius: 50%; text-align: center; justify-content: center; flex-direction: column; font-size: 16px; color: white;">';d+='                    <div class="score1">\u4f60\u7684\u5206\u6570</div>';d+='                    <div class="score2"><span class="p-score" style="font-size: 46px;">'+b["\u6700\u7ec8\u5f97\u5206"]+"</span>\u5206</div>";
d+="                </div>";d+="            </div>";d+="        </div>";d+='        <div class="title3" style="margin-top: 40px; color: #666; font-size: 18px;"><svg style="vertical-align: middle; width: 16px; height: 18px; margin-right: 12px;" t="1634033714371" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2643" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32"><defs><style type="text/css"></style></defs><path d="M204.8 51.2h614.4a102.4 102.4 0 0 1 102.4 102.4v716.8a102.4 102.4 0 0 1-102.4 102.4H204.8a102.4 102.4 0 0 1-102.4-102.4V153.6a102.4 102.4 0 0 1 102.4-102.4z m0 51.2a51.2 51.2 0 0 0-51.2 51.2v716.8a51.2 51.2 0 0 0 51.2 51.2h614.4a51.2 51.2 0 0 0 51.2-51.2V153.6a51.2 51.2 0 0 0-51.2-51.2H204.8z m277.8624 606.0032l253.44-253.44 36.1472 36.1984-289.5872 289.6384-181.0432-181.0432 36.1984-36.1984 144.8448 144.8448zM256 307.2h512v51.2H256V307.2z" p-id="2644" fill="#999999"></path></svg>\u901a\u8fc7\u5206\u6570\uff1a<span class="p-total">'+
b["\u901a\u8fc7\u5206\u6570"]||"0</span>\u5206</div>";d+="    </div>";d+="</div>";var j=document.createElement("div");j.className="mugeda_tiku_mask";j.style.cssText="position:fixed;left:0;right:0;top:0;bottom:0;text-align:center;";j.innerHTML=d;a=(c||document.body).appendChild(j)}}}();MugedaTools.iterate=function(a,b,c){for(var d in a)a.hasOwnProperty(d)&&(typeof a[d]=="object"?MugedaTools.iterate(a[d],b+"."+d,c):c&&c(a,d))};
MugedaTools.detectSecurityRisk=function(a){a=(a||"").toLowerCase();return a.match(/\b(fscommand|onabort|onactivate|onafterprint|onafterupdate|onbeforeactivate|onbeforecopy|onbeforecut|onbeforedeactivate|onbeforeeditfocus|onbeforepaste|onbeforeprint|onbeforeunload|onbeforeupdate|onblur|onbounce|oncellchange|onchange|onclick|oncontextmenu|oncontrolselect|oncopy|oncut|ondataavailable|ondatasetchanged|ondatasetcomplete|ondblclick|ondeactivate|ondrag|ondragend|ondragleave|ondragenter|ondragover|ondragdrop|ondragstart|ondrop|onend|onerror|onerrorupdate|onfilterchange|onfinish|onfocus|onfocusin|onfocusout|onhashchange|onhelp|oninput|onkeydown|onkeypress|onkeyup|onlayoutcomplete|onload|onlosecapture|onmediacomplete|onmediaerror|onmessage|onmousedown|onmouseenter|onmouseleave|onmousemove|onmouseout|onmouseover|onmouseup|onmousewheel|onmove|onmoveend|onmovestart|onoffline|ononline|onoutofsync|onpaste|onpause|onpopstate|onprogress|onpropertychange|onreadystatechange|onredo|onrepeat|onreset|onresize|onresizeend|onresizestart|onresume|onreverse|onrowsenter|onrowexit|onrowdelete|onrowinserted|onscroll|onseek|onselect|onselectionchange|onselectstart|onstart|onstop|onstorage|onsyncrestored|onsubmit|ontimeerror|ontrackchange|onundo|onunload|onurlflip|seeksegmenttime|javascript|eval|fromcharcode|window(\.|\['|\[")|document(\.|\['|\["))\b/g)||a.match(/\b(background\-image\s*\:|background\s*\:|href\s*\=|src\s*\=|style\s*\=)/g)||
a.match(/\<(script|link|img|input|style|meta|iframe|frame|table|td|tr|div|base|object|embed|xml)/g)};
MugedaMraid={mraidReadyStatus:0,mraidState:void 0,getStage:function(){var a=null;for(window.event&&(a=window.event.target||window.event.srcElement);a;){if((a.id||"").indexOf("_stage")>0||a.getAttribute&&a.getAttribute("data-mid")==0)break;a=a.parentNode}return a?a:document.getElementsByClassName("MugedaStage")[0]},setMraidState:function(a){_mrmcp=typeof _mrmcp=="undefined"?{}:_mrmcp;var b=_mrmcp.display_mode,c=mraid.getPlacementType();this.mraidState=a.toLowerCase();var d=document.getElementById("mugeda_close_button");
switch(this.mraidState){case "default":if(b!="expand"&&c!="interstitial"&&d)d.style.display="none";typeof Mugeda!="undefined"&&Mugeda.gotoAndPlay&&Mugeda.gotoAndPlay(1);break;case "expanded":(b=="auto"||b=="expand"||b=="interstitial")&&setTimeout(function(){d.style.display="block"},50);break;case "resized":setTimeout(function(){d.style.display="block"},50)}},openLink:function(a,b,c){_mrmcp=typeof _mrmcp=="undefined"?{}:_mrmcp;_mrmcp.destination_url&&_mrmcp.destination_url.indexOf("%DESTURL%")<0&&
(a=_mrmcp.destination_url);if(a){var d=function(a){var b=/^http:\/\/.*/i.test(a)||/^http%3A%2F%2F.*/i.test(a),a=/^https:\/\/.*/i.test(a)||/^https%3A%2F%2F.*/i.test(a);return!b&&!a},f=a.split("?url=");f[1]&&d(f[1])?(f[1]="http://"+f[1],a=f[0]+"?url="+f[1]):!f[1]&&d(a)&&(a="http://"+a);f=a;d="ts="+(new Date).getTime();d+="&_moid="+(_mrmcp.owner_id||"");d+="&_mcid="+(_mrmcp.creative_id||"");d+="&_mw="+(_mrmcp.width||"");d+="&_mh="+(_mrmcp.height||"");d+="&_mtp="+(_mrmcp.type||"");d+="&_mtt="+encodeURIComponent(_mrmcp.title||
"");var e=_mrmcp.custom_params;e&&e.indexOf("%CUSTOMPARAM%")<0&&(d+="&"+e);if((e=_mrmcp.redirect_url)&&e.indexOf("%LINK%")<0)var g=a.indexOf("?"),f=g<0?"?":"&",f=a=e+(e.lastIndexOf("=")==e.length-1?encodeURIComponent(a+f+d):"");var j=a.split("#"),e="";j.length>1&&(e=j[1],a=j[0]);var g=a.indexOf("?"),j=g<0?"?":"&",g=g==a.length-1,h=window.location.search;if(h){for(var h=h.split("?")[1],i=h.split("&"),n=i.length,t=0;t<n;t++){var l=i[t].split("=");if(l.length==2){var k=l[1];l[0].toLowerCase()=="mugeda_click_link"&&
(a=unescape(k),g=a.indexOf("?"),j=a<0?"?":"&",g=g==a.length-1)}}a+=(g?"":j)+h;g=false;h.length&&(j="&")}a+=(g?"":j)+d+(e?"#"+e:"");this.mraidReadyStatus==1?b=="internal"?mraid.open(f):b=="expand"?this.expand(f,0):window.open(f):b=="internal"?c?window.location.replace(f):window.location=f:b=="expand"?this.expand(f):window.open(f);MugedaTracker.fireEvent({category:"link",action:b,label:a,value:0})}},expand:function(a,b,c){_mrmcp=typeof _mrmcp=="undefined"?{}:_mrmcp;if(this.mraidReadyStatus!=1){if(a&&
a.length){var d=document.URL.match(/client.*preview.*id/),f=c=null;try{c=(d?window:window.parent).document,f=c.getElementById("mugeda_expanded")||c.createElement("div")}catch(e){window.open(a);return}a.match(/^(\/|http:|https:)/i)||(a=(_mrmcp.creative_path||"")+a);f.id="mugeda_expanded";f.style.display="block";f.style.position="fixed";f.style.width=(c.defaultView.innerWidth||c.documentElement.clientWidth)+"px";f.style.height=(c.defaultView.innerHeight||c.defaultView.innerHeight)+"px";f.style.left=
"0px";f.style.margin="0";f.style.padding="0";f.style.border="none";f.style.top="0px";f.style.background="#000";f.innerHTML="<iframe id='mugeda_expand_iframe' src='"+a+"' style='border:none;width:100%;height:100%;margin:0px;padding:0px;'></iframe>";c.body.appendChild(f);MugedaBehavior.processCloseButton("expand",c)}}else{var c=c||{},f=mraid.getMaxSize(),d=parseInt(c.width)||f.width,f=parseInt(c.height)||f.height,a=a||c.url,g=!a||a.length==0;b==1?(a=parseInt(c.left)||0,c=parseInt(c.top)||0,MugedaBehavior.processCloseButton("resize"),
mraid.setResizeProperties({width:d,height:f,offsetX:a,offsetY:c,allowOffscreen:false}),mraid.resize()):(mraid.setExpandProperties({width:d,height:f,isModal:true,useCustomClose:_mrmcp.display_mode?true:false}),g?(mraid.expand(),MugedaBehavior.processCloseButton()):mraid.expand(a))}},sendEmail:function(a){window.open("mailto:"+a.email_addr+"?subject="+a.email_title+"&body="+a.email_body,"_self")},savePicture:function(a){this.mraidReadyStatus==1&&mraid.supports("storePicture")&&mraid.storePicture(a.url)},
addCalendarEvent:function(a){this.mraidReadyStatus==1&&mraid.supports("calendar")&&mraid.createCalendarEvent({summary:a.calendar_summary,description:a.calendar_desc,location:a.calendar_location,start:a.calendar_start_time,end:a.calendar_end_time})},createHTML5VideoTag:function(a,b){if(a){var c="_"+ +new Date,d=0,f=0;a.data&&(c="_"+a.data.guid,a.data.param&&(d=a.data.param.continueAudio||0,f=a.data.param.clickStatus||0));var e=G("mugeda_video"+c);if(e)return e.parentNode;div=document.createElement("div");
div.className="mugedaVideoHolder";div.style.margin=0;div.style.padding=0;div.style.backgroundColor="rgba(0,0,0,0)";div.style.position="absolute";div.style.top=0;div.style.left=0;div.style.width=0;div.style.height=0;div.style.zIndex=1;div.style.display="none";var g=document.querySelector('[data-type="stage"]'),j=document.documentElement.clientWidth,h=document.documentElement.clientHeight;navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i);var i='<div id="mugeda_video_close'+c+
'" align="middle" style="position: absolute;color:white;width:36px;height:36px;right:0px;top: '+(g.clientWidth>g.clientHeight!=j>h?h-36:0)+"px;cursor:pointer;background-image:url("+close_img_url+');z-index:3;"></div>',i='<video id="mugeda_video'+c+'" '+(b.video_embed?'x5-video-player-type="h5" x5-video-player-fullscreen="true"':"")+' controls playsinline x-webkit-airplay webkit-playsinline x5-playsinline preload="auto" video-id="'+b.id+'"  video-mode="'+b.mode+'" video-name="'+b.name+'"  style="position:absolute;z-index:2;'+
function(){var a="";g.clientWidth>g.clientHeight!=j>h?(a+="transform-origin: center;",a+="webkit-transform: rotate(90deg);",a+="transform: rotate(90deg);",a+="width:"+h+"px;",a+="height:"+j+"px;",a+="left:"+(j-h)/2+"px;",a+="top:"+(h-j)/2+"px;"):(a+="width: 100%;",a+="height: 100%;",a+="left: 0;",a+="top: 0;");return a}()+'"></video>'+i;div.innerHTML=i;a.appendChild?a.appendChild(div):a.dom&&a.dom.appendChild(div);e=G("mugeda_video"+c);c=G("mugeda_video_close"+c);c.style.display=b.close_button?"block":
"none";b.close_button&&(i=isMobile()?"touchend":"click",c.addEventListener(i,function(a){a.stopPropagation();e.src="";e.rawSrc="";e.load();div.style.display="none"},false));b.video_controls?e.setAttribute("controls","controls"):e.removeAttribute("controls");e.rawPlay=e.play;e.rawPause=e.pause;e.play=function(){if(e.paused){if((e.src==""||e.src==window.location.href)&&e.backSrc)e.src=e.backSrc;if(e.rawSrc==""&&e.backRawSrc)e.rawSrc=e.backRawSrc;e.onplayed();e.rawPlay();Mugeda.DataStats.entry({type:"playVideo",
target:e,id:e.getAttribute("video-id")});for(var a=e.parentElement;a;)if(a.className=="mugedaVideoHolder"){a.style.display="block";break}else a=a.parentElement}};e.pause=function(){e.onpaused();e.rawPause();Mugeda.DataStats.entry({type:"stopVideo",id:e.getAttribute("video-id"),target:e})};e.onplayed=function(){if(d==0&&window.backgroundMusic)backgroundMusic.prevPlayStatus=backgroundMusic.playStatus,backgroundMusic.pause(),backgroundMusic.playStatus=0};e.onpaused=function(){if(d==0&&window.backgroundMusic&&
backgroundMusic.prevPlayStatus==1)backgroundMusic.play(),backgroundMusic.playStatus=1,delete backgroundMusic.prevPlayStatus};e.onclick=function(a){a.preventDefault();a.stopPropagation();f===0?this.paused?this.play():this.pause():this.paused&&this.play()};return div}},loadUrl:function(a){var b=a.id||(new Date).getTime(),c=a.url||"",d=a.left||0,f=a.top||0,e=isNaN(a.width)?window.aniData?window.aniData.width:320:Math.max(0,a.width),g=isNaN(a.height)?window.aniData?window.aniData.height:240:Math.max(0,
a.height),j=a.before||null,h=a.style,i=a.scroll,n=a.parent,t=a.onload,l=a.onclose,k=a.position,x=a.close_position;if(!j&&!n){var w=typeof Mugeda!="undefined"&&Mugeda.getCanvas?Mugeda.getCanvas():this.getStage();typeof Mugeda!="undefined"&&w&&(w=getElementOffset(w),d+=w.left,f+=w.top)}var q=G(b);q||(q=document.createElement("div"),n?n.appendChild(q):j?j.parentNode.insertBefore(q,j):document.body.appendChild(q));q.id=b;q.style.margin=0;q.style.padding=0;q.style.backgroundColor="transparent";q.style.position=
k?k:"fixed";q.style.top=0;q.style.left=0;q.style.width=0;q.style.height=0;switch(x){case "leftTop":x="left:4px;top:4px;";break;case "leftbottom":x="left:4px;bottom:4px;";break;case "rightbottom":x="right:4px;bottom:4px;";break;default:x="right: 4px;top: 4px;"}q.innerHTML="<iframe "+(i?"":"scrolling=no ")+'id="'+b+'_iframe" style="border:none; width:100%;height:100%; '+(i?"":"overflow:hidden;")+' " ></iframe>'+('<div id="'+b+'_iframe_close" align="middle" style="position: absolute;color:white;width: 24px;height: 24px; '+
x+'cursor:pointer;background: rgba(0,0,0,0.5);border: 3px solid white;border-radius: 15px;font-family:arial;font-size: 16px;line-height:24px;">&#10006;</div>');q.style.display="none";q.style.top=f+"px";q.style.left=d+"px";q.style.width=e+"px";q.style.height=g+"px";q.style.display="block";q.style.cssText+=h;G(b+"_iframe_close").style.display=a.close_button?"block":"none";setTimeout(function(){if(a.close_button)G(b+"_iframe_close").onclick=function(){q.style.display="none";G(b+"_iframe").src="about:blank";
l&&l(q)}},100);setTimeout(function(){var a=G(b+"_iframe");a.src=c;if(t)try{a.onload=function(){t(a);a.onload=null}}catch(e){}},100);return q},playAudio:function(a,b){var c=false;if(!a||!a.audio_url||!a.audio_url.length)return false;var d=typeof Mugeda!="undefined"&&Mugeda.getAudioCache?Mugeda.getAudioCache(a.audio_url,a.audioId):MugedaBehavior.localCache[a.audio_url];if(d){if(d.loop=parseInt(a.audio_loop)==1?true:false,d.play)if(d.webAudio)c=d.play(a.event=="click"||b?true:false);else if(a.event==
"click"){try{d.pause(),d.currentTime=0}catch(f){}setTimeout(function(){d.play()},5)}else(d.playStatus!=1||b)&&setTimeout(function(){d.play();d.playStatus=1;c=true},10)}else{var d=new Audio,e=document.createElement("source"),g=a.audio_url.lastIndexOf("."),g=a.audio_url.substring(g+1),j=true;switch(g){case "ogg":e.type="audio/ogg";break;case "mp3":e.type="audio/mpeg";break;default:j=false,console.log("Audio extension ("+g+") not supported.")}if(j){e.src=a.audio_url;d.appendChild(e);d.autoplay=false;
d.preload="auto";d.load();var h=document.getElementById("mugeda_resource_loading");if(!h)h=document.createElement("img"),h.id="mugeda_resource_loading",h.style.position="fixed",h.style.right="2px",h.style.top="2px",h.style.display="block",h.src=creative_path+"images/loading.gif",document.body.appendChild(h);h.style.display="block";c=true;d.addEventListener("canplay",function(){h.style.display="none";d.play()},false);MugedaBehavior.localCache[a.audio_url]=d}}return c},playHTML5Video:function(a){var b=
a.left||0,c=a.top||0,d=isNaN(a.width)?"100%":Math.max(0,a.width)+"px",f=isNaN(a.height)?"100%":Math.max(0,a.height)+"px",e=window.Mugeda&&Mugeda.getCanvas?Mugeda.getCanvas():this.getStage();typeof Mugeda!="undefined"&&e&&!a.video_holder&&!isNaN(a.left)&&(e=getElementOffset(e),b+=e.left,c+=e.top);var g=document.body;if(a.video_holder)if((e=Mugeda.getMugedaObject?Mugeda.getMugedaObject():null)&&e.scene){var g=a.video_holder,g=g.split("/"),j=a.video_object===1;if(g.length===2)e=e.scene.getObjectByName(j?
g[1]:g[0]),j?(g=e?e.scene.objectHash[g[0]]:null,a.url=g?g.data.param.videoUrl:a.url):g=e?e.scene.getObjectByName(g[1]):null;else if(j){if((g=e.scene.objectHash[a.video_holder])||(g=e.scene.dom.querySelector('*[data-guid="'+a.video_holder+'"]')),g&&g.data)a.url=g.data.param.videoUrl}else g=e.scene.getObjectByName(a.video_holder)}else{if(window.mugedaCss&&mugedaCss.magic&&(e=document.getElementById(mugedaCss.magic+"stage")))g=a.video_holder,g=g.split("/").map(function(a){return"."+a}),(g=e.querySelectorAll(g.join(" ")))&&
g.length&&(g=g[0])}else g=document.body;var h=this.createHTML5VideoTag(g,a);h.style.top=c+"px";h.style.left=b+"px";h.style.width=d;h.style.height=f;h.style.display="block";var i=h.querySelector("video");i.src=a.url;i.rawSrc=a.url;i.load();setTimeout(function(){if(a.showLoading)MugedaTools.message.show(null,{hideShade:true,parent:h,center:true}),i.loadingShown=true,i.ontimeupdate=function(){if(i.loadingShown)MugedaTools.message.close(),i.loadingShown=false};a.event=="appear"&&(window.WeixinJSBridge?
WeixinJSBridge.invoke("getNetworkType",{},function(){i.play();i.playing=true},false):document.addEventListener("WeixinJSBridgeReady",function(){WeixinJSBridge.invoke("getNetworkType",{},function(){i.play();i.playing=true})},false));i.play();i.playing=true},10)},playVideo:function(a){a=a||{};if(!a.video_url)return false;if(this.mraidReadyStatus!=1){var b=a.dom||document.querySelector('video[video-id="'+a.video_id+'"]');a.video_mode=="object"&&a.video_id&&b&&b.rawSrc==a.video_url||this.playHTML5Video({url:a.video_url,
id:a.video_id||"",name:a.video_name||"",mode:a.video_mode||"",video_object:parseInt(a.video_object,10),video_holder:a.video_holder,left:parseInt(a.video_left,10),top:parseInt(a.video_top,10),width:parseInt(a.video_width,10),height:parseInt(a.video_height,10),close_button:parseInt(a.video_close,10)==1,video_controls:parseInt(a.video_controls,10)==1,video_embed:parseInt(a.video_embed,10)==1,auto:parseInt(a.video_autoplay,10)==1,event:a.event})}else mraid.playVideo(a.video_url)},stopVideo:function(){for(var a=
document.querySelectorAll("div.mugedaVideoHolder"),b=0,c=a.length;b<c;b++){var d=a[b].querySelector("video");if(d)d.backSrc=d.src,d.backRawSrc=d.rawSrc,d.src="",d.rawSrc="",d.load();a[b]&&(a[b].style.display="none")}},controlVideo:function(a,b){var c=document.querySelector("#mugeda_video_"+a);if(c)if(b=="play")c.play();else if(b=="pause")c.pause();else{if(b=="stop")c.pause(),c.currentTime=0}else if((c=Mugeda.getMugedaObject?Mugeda.getMugedaObject():null)&&c.scene)if(c=c.scene.objectHash[a]){var d=
c.data.param;b==="play"&&MugedaMraid.playVideo({auto:d.videoAutoPlay,clickStatus:d.clickStatus,event_name:"",hidePlayIcon:d.hidePlayIcon,video_close:0,video_continue_audio:d.continueAudio,video_controls:d.hidePlayControls==1?0:1,video_holder:c.data.guid,video_left:0,video_mode:"object",video_name:d.name,video_embed:d.embedVideo,video_object:1,video_top:0,video_url:d.videoUrl})}},sendShortMessage:function(a){var b="sms:"+a.phone_number;if(a.sms_body){var c=navigator.userAgent.toLowerCase().indexOf("android")>
-1;b+=(c?"?":"&")+"body="+a.sms_body}window.open(b,"_self")},makePhoneCall:function(a){window.open("tel:"+a.phone_number,"_self")}};
Mugeda.getContentId=function(){var a="",b=0;if(_mrmcp.creative_id)a=_mrmcp.creative_id,_mrmcp.previewMode&&(b=3);else if(Mugeda&&Mugeda.data&&Mugeda.data.crid)a=Mugeda.data.crid,b=3;if(a==""&&/\/edit\/(\w+)\&?/.test(top.location.href))a=RegExp.$1,a.length<16?parent&&parent.crid?(a=parent.crid,b=2):b=1:b=2;else if(a==""&&/id=(\w+)\&?/.test(window.location.search))b=3,a=RegExp.$1;return{crid:a,mode:b}};
MugedaBehavior={localCache:{},shakeHash:{},pause:function(){typeof Mugeda!="undefined"&&Mugeda.pause&&Mugeda.pause()},resume:function(a){typeof Mugeda!="undefined"&&Mugeda.resume&&Mugeda.resume(a)},nextPage:function(){typeof Mugeda!="undefined"&&Mugeda.nextPage&&Mugeda.nextPage()},prevPage:function(){typeof Mugeda!="undefined"&&Mugeda.prevPage&&Mugeda.prevPage()},gotoPage:function(a){typeof Mugeda!="undefined"&&Mugeda.gotoPage&&Mugeda.gotoPage(a)},disablePage:function(){typeof Mugeda!="undefined"&&
Mugeda.disablePage&&Mugeda.disablePage()},disablePageForward:function(){typeof Mugeda!="undefined"&&Mugeda.disablePageForward&&Mugeda.disablePageForward()},disablePageAfter:function(){typeof Mugeda!="undefined"&&Mugeda.disablePageAfter&&Mugeda.disablePageAfter()},enablePage:function(){typeof Mugeda!="undefined"&&Mugeda.enablePage&&Mugeda.enablePage()},enablePageForward:function(){typeof Mugeda!="undefined"&&Mugeda.enablePageForward&&Mugeda.enablePageForward()},enablePageAfter:function(){typeof Mugeda!=
"undefined"&&Mugeda.enablePageAfter&&Mugeda.enablePageAfter()},next:function(){typeof Mugeda!="undefined"&&Mugeda.next&&Mugeda.next()},previous:function(){typeof Mugeda!="undefined"&&Mugeda.previous&&Mugeda.previous()},gotoAndPlay:function(a){typeof Mugeda!="undefined"&&Mugeda.gotoAndPlay&&Mugeda.gotoAndPlay(a)},gotoAndStop:function(a){gotoAndPause(a)},gotoAndPause:function(a){typeof Mugeda!="undefined"&&Mugeda.gotoAndPause&&Mugeda.gotoAndPause(a)},callback:function(a,b){var c=Mugeda.getMugedaObject?
Mugeda.getMugedaObject():null,d=null;c&&(d=c.getCallback(b.name));!d&&window&&b.name&&b.name.length&&window[b.name]&&(d=window[b.name]);d&&d(a,b.key,b.value)},map:function(a){var b=a.map_key.replace(/(\n|\r)/g,"+"),c=void 0;if(a.map_address){var c=a.map_address.replace(/(\n|\r)/g,"+"),d=navigator.userAgent.toLowerCase().indexOf("android")>-1,f=parseInt(a.map_type,10),e=function(){for(var a=document.querySelectorAll("div.mugedaVideoHolder"),b=0,c=a.length;b<c;b++)a[b]&&(a[b].style.display="none");
(a=G("mugedaMap-mask"))?g(1):(a=document.createElement("div"),b=creative_path+"images/loading.gif",a.id="mugedaMap-mask",a.className="mugedaMapControl",a.innerHTML='<p id="mugedaMap-title"><a id="mugedaMap-back">\u8fd4\u56de</a>\u4f4d\u7f6e\u4fe1\u606f</p><div id="mugedaMap-con"></div><div id="mugedaMap-loading"><div class="spinner"></div><style>.smnoprint {top: 70px!important;}.BMap_stdMpCtrl {top: 70px!important;}.BMap_stdMpCtrl.BMap_stdMpType1.BMap_noprint.anchorTR {top: 80px!important;}.BMap_noprint.anchorTR {display: none!important;}.amap-toolbar {right: 10px!important; bottom: 10px!important;left: auto!important; top: auto!important;}.mugedaMapControl {position:absolute;left:0;top:0;height:100%;width:100%;z-index:999;}.mugedaMapMaskVisible {-webkit-transition:transform 1s;transform:translate3d(-100%, 0, 0);-webkit-transform:translate3d(-100%, 0, 0);}.mugedaMapControl #mugedaMap-title {position:fixed;height:44px;line-height:44px;width:100%;text-align:center;z-index:1;background:rgba(255,255,255,.8);margin:0;}.mugedaMapControl #mugedaMap-con {height:100%;width:100%;}.mugedaMapControl #mugedaMap-back {position:absolute;left:5px;display:inline-block;height:100%;width:40px;cursor:pointer;}.mugedaMapControl #mugedaMap-loading {position:absolute;width:100%;height:100%;line-height:100%;left:0;top:44px;display:none;background:#fff;z-index:2;}.mugedaMapControl .spinner {position:absolute;width:20px;height:30px;left:50%;top:50%;margin:-50px 0 0 -10px;background-image:url('+
b+');background-repeat:no-repeat;background-size:contain;}.mugedaMapControl .spinner:after {content: "\u52a0\u8f7d\u4e2d ...";position:absolute;width:80px;left:-25px;top:120%;}</style>',document.body.appendChild(a),(a=G("mugedaMap-back"))&&a.addEventListener("click",function(a){a.stopPropagation();g(0)},false))},g=function(a){var b=G("mugedaMap-mask");b&&b.classList.toggle("mugedaMapMaskVisible",!a)},j=function(a){var b=G("mugedaMap-loading");if(b)b.style.display=a?"block":"none"},h,i,n=function(a,
b,c,e){h||(h=new BMap.Map("mugedaMap-con"));h.addControl(new BMap.MapTypeControl({mapTypes:[BMAP_NORMAL_MAP,BMAP_HYBRID_MAP]}));var c=new BMap.NavigationControl,d=new BMap.NavigationControl({anchor:BMAP_ANCHOR_TOP_RIGHT,type:BMAP_NAVIGATION_CONTROL_SMALL});h.addControl(c);h.addControl(d);i||(i=new BMap.LocalSearch(h,{renderOptions:{map:h,autoViewport:true},onSearchComplete:function(a){typeof e==="function"&&e.call(h,a)}}));b&&a?i.searchNearby(b,a):i.search(b)},t,l=function(a,b){console.log(a,b);t||
(t=new AMap.Map("mugedaMap-con",{resizeEnable:true,zoom:3}));AMap.plugin(["AMap.ToolBar","AMap.PlaceSearch","AMap.CitySearch"],function(){var c=new AMap.ToolBar;t.addControl(c);(new AMap.PlaceSearch({city:a})).search(b,function(a,b){if(a==="error")Mugeda.messageBox("\u62b1\u6b49\uff0c\u83b7\u53d6\u5730\u5740\u51fa\u9519","alert"),b==="USER_DAILY_QUERY_OVER_LIMIT"&&(b="\u670d\u52a1\u4f7f\u7528\u8d85\u9650"),console.warn("[\u884c\u4e3a - \u5730\u56fe] "+b);else if(console.log(b),b.poiList.pois.length){for(var c=
b.poiList.pois,e=0;e<c.length;e++){var d=c[e],f=[];f[e]=new AMap.Marker({position:d.location,title:d.name});t.add(f[e])}t.setFitView()}else Mugeda.messageBox("\u62b1\u6b49\uff0c\u6ca1\u6709\u641c\u7d22\u5230\u76f8\u5173\u4fe1\u606f","alert")})})};window.buildTengxunMap=function(){if(!e)var a=new qq.maps.LatLng(39.916527,116.397128),e=new qq.maps.Map(document.getElementById("mugedaMap-con"),{center:a,zoom:6,mapTypeControlOptions:{mapTypeIds:[qq.maps.MapTypeId.ROADMAP,qq.maps.MapTypeId.SATELLITE,qq.maps.MapTypeId.HYBRID],
position:qq.maps.ControlPosition.BOTTOM_CENTER}});var d=new qq.maps.LatLngBounds,f=[],a=new qq.maps.SearchService({complete:function(a){for(var a=a.detail.pois,b=0,c=a.length;b<c;b++){var g=a[b];d.extend(g.latLng);g=new qq.maps.Marker({map:e,position:g.latLng});g.setTitle(b+1);f.push(g)}e.fitBounds(d)}});a.setLocation(c);a.search(decodeURIComponent(b))};var k=function(a,b,c){if(f===0){var d=["//api.map.baidu.com/api?v=3.0&ak=FOm6cLbES9zjrtvcDYndkwSR","//api.map.baidu.com/getscript?v=3.0&ak=FOm6cLbES9zjrtvcDYndkwSR"],
b=decodeURIComponent(b),a=decodeURIComponent(a);e();j(1);for(var g=0,h=0,i=d.length;h<i;h++)c=document.createElement("script"),c.src=d[h],c.onload=function(){++g===i&&n(a,b,"",function(a){a.getNumPois()===0&&Mugeda.messageBox("\u62b1\u6b49\uff0c\u6ca1\u6709\u641c\u7d22\u5230\u76f8\u5173\u4fe1\u606f","alert");j(0)})},document.head.appendChild(c)}else if(f===1)if(h="https://maps.google.com/maps?q="+(a+""+(b.length?"+near+"+b:""))+"&z=12",d=parseFloat((""+(/CPU.*OS ([0-9_]{1,5})|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||
[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))||false,c==1){if(c=document.getElementById("aMugedaGeoLocation"))c.href=h,h=document.createEvent("HTMLEvents"),h.initEvent("click",true,true),c.dispatchEvent(h)}else d&&d<6?window.location.href=h:window.open(h,"_blank");else if(f===2){d=["//webapi.amap.com/maps?v=1.4.15&key=189d47fd622309f74807543767b6cf5f"];e();j(1);h=g=0;for(i=d.length;h<i;h++)c=document.createElement("script"),c.src=d[h],c.onload=function(){++g===i&&(l(decodeURIComponent(b),
decodeURIComponent(a)),j(0))},document.head.appendChild(c)}else if(f===3){d=["//map.qq.com/api/js?v=2.exp&key=Q2XBZ-BQ56F-6DCJD-NIGR5-65MDQ-FCBJG&callback=buildTengxunMap"];e();j(1);h=g=0;for(i=d.length;h<i;h++)c=document.createElement("script"),c.src=d[h],c.onload=function(){++g===i&&j(0)},document.head.appendChild(c)}};if(!d&&c.length==0&&navigator.geolocation){a=document.getElementById("aMugedaGeoLocation");if(!a)a=document.createElement("a"),a.id="aMugedaGeoLocation",a.style.display="none",a.href=
"",a.target="_blank",document.body.appendChild(a);navigator.geolocation.getCurrentPosition(function(a){c=a.coords.latitude+","+a.coords.longitude;k(b,c,1)})}else k(b,c)}else Mugeda.messageBox("\u672a\u8bbe\u7f6e\u5730\u5740\uff0c\u8bf7\u5728\u884c\u4e3a\u91cc\u8fdb\u884c\u8bbe\u7f6e\u3002","alert")},popupForm:function(a,b){function c(a,b){if(a&&b)return a.querySelector("#"+b)}function d(a){if(window.localStorage&&window.localStorage.getItem)return unescape(localStorage.getItem(a)||"");var b,c,e,d=
document.cookie.split(";");for(b=0;b<d.length;b++)if(c=d[b].substr(0,d[b].indexOf("=")),e=d[b].substr(d[b].indexOf("=")+1),c=c.replace(/^\s+|\s+$/g,""),c==a.toLowerCase())return unescape(e);return""}function f(a,b){if(window.localStorage&&window.localStorage.getItem)try{localStorage.setItem(a,escape(b))}catch(c){console.info("Oops, localStorage full"),localStorage.clear(),localStorage.setItem(a,escape(b))}else{var e=new Date;e.setDate(e.getDate()+3);e=escape(b)+"; expires="+e.toUTCString();document.cookie=
a.toLowerCase()+"="+e}}function e(a){var b=document.querySelector(".MugedaStage")?null:G("viewbox")||G("frame");if(b)b.style.display=a?"":"none";return b?true:false}function g(a){if(b){var c=function(a,b){Array.prototype.forEach.call(a,function(a,c){b(a,c)})};c(a.querySelectorAll(".popupFormInputBox input,.popupFormInputBox textarea"),function(a){a.value=""});c(a.querySelectorAll(".popupFormRadioList input,.popupFormCheckbox input"),function(a){a.checked=false});c(a.querySelectorAll(".popupFormSelectList select"),
function(a){a.value=a.querySelector("option").getAttribute("value")})}else if(c=a.querySelector("form"),c.style.bottom=-c.offsetHeight+"px",a.style.background="rgba(0,0,0,0)",setTimeout(function(){a.parentNode&&a.parentNode.removeChild(a)},500),e(1)&&(document.body.style.overflowY="hidden",isMobile()))document.body.style.height="100%"}var j=a.openTarget=="default"||a.openTarget=="frame"||a.openTarget=="page";if(a&&!(a.openTarget=="callback"&&!a.callback||a.openTarget!="callback"&&a.openTarget!="customizable"&&
!j&&!a.url)){var j=document.documentElement.clientWidth,h=document.documentElement.clientHeight,i=[],n=function(b,c){var c=c||{},e=c.detail,d=c.form||(e?e.form:null),e={item:e,form:d,title:a.title,hideItem:function(a){d&&d.elements[a]&&(d.elements[a].parentNode.style.display="none")},showItem:function(a){d&&d.elements[a]&&(d.elements[a].parentNode.style.display="block")}},c=document.createEvent("Events");c.initEvent(b,true,true);c.detail=e;window.dispatchEvent(c)};window.addEventListener("_mugedaFormChanged",
function(a){n("mugedaFormChanged",a)});var t=a.items||[];window.popupFormFields=t;if(!a.html){var l="";b?(l+='<div class="popupFormContent">',a.title&&(l+='<div align="center" class="popupFormTitle"><h2>'+a.title+"</h2></div>")):(l+='<div align="center" class="popupFormTitle">',l+='<div class="title-col-2" align="center"><input type="button" value="'+a.cancelName+'" class="popupFormCancel" id="popupFormCancel"></div>',l+='<div class="title-col-6" align="center"><h2>'+(a.title||"&nbsp;")+"</h2></div>",
l+='<div class="title-col-2" align="center"><input id="actionButton" type="button" value="'+a.submitName+'" class="popupFormSubmit"></div>',l+="</div>",l+='<div class="popupFormContent">');var k=navigator.userAgent.toLowerCase(),x=k.indexOf("android")>-1,w=parseFloat(k.slice(k.indexOf("android")+8)),q="",v=0,o={phone:"tel",input:"text"};x&&w<3&&(q="-webkit-transform: scale(2,2);-webkit-transform-origin:center center;");for(var y=b?"":":",k=0;k<t.length;k++){var m=t[k],z=(m.value||"").trim();if(z){for(var z=
z.split("\n"),r=[],u=0;u<z.length;u++){var I=z[u].split("("),B=I[0],I=(I[1]||"").replace(/\)$/,"")||B,D=["FORMID",I,k,u].join("_");r[u]={id:D,text:B,value:I}}z=r}D='id="popupFormField_'+k+'"';switch(m.type){case "radio":l+="<div "+D+' class="popupFormRadioList">';m.description&&(l+='<label class="inputlabel">'+m.description+(m.required?"*":"")+y+"</label>");l+='<div class="mformradio">';for(u=0;u<z.length;u++)r=z[u],B=d(r.id),l+='<label><input onchange="var event = document.createEvent(\'Events\');event.initEvent(\'_mugedaFormChanged\', true, true);event.detail = this;window.dispatchEvent(event);" type="radio" name="'+
m.id+'" value="'+r.value+'" id="'+r.id+'" '+(B=="true"?"checked=checked":"")+" ><span "+(u==z.length-1?"":" style='border-right:1px solid "+a.background+"'")+">"+r.text+"</span></label>",i[r.id]=r.id;l+="</div></div>";break;case "checkbox":l+="<div "+D+' class="popupFormCheckbox">';m.description&&(l+='<label class="inputlabel">'+m.description+(m.required?"*":"")+y+"</label>");l+='<div class="mformcheck">';l+=m.rangeType==="vertical"?"<table>":"";for(u=0;u<z.length;u++)r=z[u],B=d(r.id),l+=m.rangeType===
"vertical"?'<tr><td><input type="checkbox" value="'+r.value+'" id="'+r.id+'" '+(B=="true"?"checked=true":"")+' ></td><td><label for="'+r.id+'" >'+r.text+"</label></td></tr>":'<input onchange="var event = document.createEvent(\'Events\');event.initEvent(\'_mugedaFormChanged\', true, true);event.detail = this;window.dispatchEvent(event);" type="checkbox" name="'+m.id+'" value="'+r.value+'" id="'+r.id+'" '+(B=="true"?"checked=true":"")+' ><label for="'+r.id+'" >'+r.text+"</label>",i[r.id]=r.id;x&&w<
3&&m.rangeType!="vertical"&&(v=6);l+=m.rangeType==="vertical"?"</table>":"";l+="</div></div>";break;case "select":l+="<div "+D+' class="popupFormSelectList">';m.description&&(l+='<label class="inputlabel text">'+m.description+(m.required?"*":"")+y+"</label>");l+='<select class="text" onchange="var event = document.createEvent(\'Events\');event.initEvent(\'_mugedaFormChanged\', true, true);event.detail = this;window.dispatchEvent(event);" name="'+m.id+'" id="'+("_map_"+m.description)+'">';l+='<option value="">'+
m.description+"</option>";B=d(m.description);for(u=0;u<z.length;u++)r=z[u],l+='<option value="'+r.value+'" '+(B==r.value?"selected=selected":"")+">"+r.text+"</option>";l+="</select>";l+="</div>";i[m.description]="_map_"+m.description;break;case "textarea":l+="<div "+D+' class="popupFormInputBox">';l+='<label class="inputlabel inputlabel_area">'+m.description+(m.required?"*":"")+y+'</label><textarea name="'+m.id+'" id="_mcp_'+escape(m.description)+'" rows="4" onchange="var event = document.createEvent(\'Events\');event.initEvent(\'_mugedaFormChanged\', true, true);event.detail = this;window.dispatchEvent(event);" style="resize:none; height:48px;">'+
(m.value.length?m.value:d(m.description))+"</textarea>";l+="</div>";i[m.description]="_mcp_"+escape(m.description);break;default:l+="<div "+D+' class="popupFormInputBox">',l+='<label class="inputlabel text">'+m.description+(m.required?"*":"")+y+'</label><input class="text" name="'+m.id+'" id="_mcp_'+escape(m.description)+'" type="'+(o[m.type]||m.type)+"\" onchange=\"var event = document.createEvent('Events');event.initEvent('_mugedaFormChanged', true, true);event.detail = this;window.dispatchEvent(event);\" value=\""+
(d(m.description)||m.value)+'" '+(b?'placeholder="'+m.description+'"':"")+">",l+="</div>",i[m.description]="_mcp_"+escape(m.description)}}b&&(l+='<div class="popupFormBtn"><input type="button" value="'+a.cancelName+'" class="popupFormCancel" id="popupFormCancel">',l+='<input id="actionButton" type="button" value="'+a.submitName+'" class="popupFormSubmit"></div>');l+="</div>";a.html=l}delete this.popupFormDiv;var p=this.popupFormDiv;if(!p){k=function(c){var c=c||".popupForm",e=1;if(/^rgba\(\d+,\s\d+,\s\d+,\s([0-9.]+)\)$/.exec(a.background))e=
RegExp.$1;e="<style>"+c+" {width:100%;font-size:"+a.fontSize+'px;font-family:Tahoma,"\u5fae\u8f6f\u96c5\u9ed1",Arial, SimHei;}'+c+' * {font-family:Tahoma,"\u5fae\u8f6f\u96c5\u9ed1",Arial, SimHei;}'+c+" form{position:absolute;width:100%;background-color:"+a.background+";}"+c+" *{margin:0;box-sizing:border-box;-webkit-appearance: none; -moz-appearance: none; appearance: value;}"+c+" .inputlabel{width:33%;height:28px;font-size:"+a.fontSize+"px;line-height:28px;display:inline-block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;vertical-align:top;color:#000;}"+
c+" span{color:#333;}"+c+" label{color:#000;}"+c+" #popupFormField_0{padding-top:16px;}"+c+" .popupFormMask {position:absolute;left:0;top:0;width:100%;height:100%;background-color: "+a.background+"}"+c+" .popupFormContent {padding-bottom:16px; background-color:#fff;opacity:"+e+";}"+c+" .popupFormTitle {width:100%;padding:20px 0;overflow:hidden;background-color: "+a.background+"}"+c+" h2 {font-weight:normal;font-size:"+(2+parseInt(a.fontSize))+"px;color:"+a.color+";}"+c+" h3{text-align:left;font-size:"+
a.fontSize+"px; font-weight: normal;color:"+a.color+";}"+c+" .popupFormInputBox{padding:8px 16px;text-align:left;}"+c+" .popupFormInputBox input, .popupFormInputBox textarea, .popupFormSelectList select{width:67%;height:28px;border:1px solid "+a.background+";font-size:"+a.fontSize+"px;padding:0;padding-left:8px;vertical-align:top;border-radius:2px;}"+c+" .popupFormSelectList{padding:8px 16px 0;}"+c+" .popupFormRadioList{padding:8px 16px 0;}"+c+" .popupFormCheckbox{padding:8px 16px 0;}"+c+" .popupFormTitle input{border-width:0;cursor:pointer;font-size:"+
a.fontSize+"px;color:"+a.color+"}"+c+" .popupFormSubmit{border:none;background:none}"+c+" .popupFormCancel{background:none;border:none;}"+c+" .popupFormRadioList input{margin:0 5px 0 8px;}"+c+" .popupFormRadioList label{vertical-align:top;}"+c+" .mformradio {background-color:#EFEFEF;border:1px solid "+a.background+";overflow:hidden;display:inline-block;}"+c+" .mformradio label{float:left; min-width:48px;position:relative;}"+c+" .mformradio label span{text-align:center;padding:6px 8px;display:block;}"+
c+" .mformradio label input{position:absolute;width:100%;height:100%;margin:0;border:0;opacity:0;}"+c+" .mformradio input:checked + span{background-color:"+a.background+";color:#F7F7F7;}"+c+" .mformcheck{margin:0 0 8px;display:inline-block;}"+c+" .mformcheck input{"+q+"width:24px;height:24px;background-color:#EFEFEF;border:1px solid "+a.background+";vertical-align:middle;margin:3px 2px;}"+c+" .mformcheck input:checked{background-color:"+a.background+";}"+c+" .popupFormTitle .title-col-2 {float:left;width:20%;padding:0 ;text-align:center;}"+
c+" .popupFormTitle .title-col-6 {float:left;width:60%;padding:0 ;}"+c+" .popupFormTitle .title-col-2 input {font-size:"+(2+parseInt(a.fontSize))+"px;}"+c+" .mformcheck label{vertical-align:"+v+"px;font-size:"+a.fontSize+"px;padding-top:0;padding-left:4px;padding-right:8px;}";b&&(e+=c+" .popupFormBtn {width:100%;padding:20px 0 0 0;text-align:center;}",e+=c+" .popupFormSubmit {width:90px;height:30px;color:"+a.color+";background-color:"+a.background+"}",e+=c+" .popupFormCancel {width:90px;height:30px;margin-right:15px;color:"+
a.color+";display:none;background-color:"+a.background+"}");e+="</style>";return e};if(!p){var H=a.openTarget=="backend"?"popupFormIframe":"_"+a.openTarget,p=document.createElement("div");p.style.display="none";p.className=b?"popupForm2":"popupForm";var F="";if(b)var C=function(b){for(var c={l:48,r:200},e=0,d=0,f=b.length;d<f;d++){for(var g=b[d],h=g.description.length,i=0,j=0;j<h;j++)i+=g.description[j].match(/[\u3400-\u9FBF]/)?2:1;e=Math.max(e,i)}e=e>8?8:e;b=a.fontSize*(e-4);e>4&&e<=8&&(c.l+=b,c.r-=
b);return c}(t),F=k(".popupForm2");else F=k();p.innerHTML='<form method="'+a.method+'" target="'+H+'" autocomplete="on"></form><iframe name="popupFormIframe" id="popupFormIframe" style="display:none"></iframe>'+F;!b&&!a.isCss?document.body.appendChild(p):(a.hwObj=C,a.iframeDiv=p,a.parentDom&&a.parentDom.appendChild(a.iframeDiv));this.popupFormDiv=p;p.form=p.childNodes[0];p.form.onclick=function(){};self=this;b||p.addEventListener(isMobile()?"touchend":"mouseup",function(a){if(!window.cardFrame){if(a.target==
p)g(p),self.popupFormDiv=null,a.stopPropagation();var b=a.target.nodeName.toLowerCase(),c=(a.target.type||"").toLowerCase();["input","textarea","select"].indexOf(b)>=0&&c!="checkbox"&&c!="submit"&&(a.target.focus(),x&&setTimeout(function(){a.target.scrollIntoView();a.target.scrollIntoViewIfNeeded&&a.target.scrollIntoViewIfNeeded()},500),a.stopPropagation());c=="button"&&a.stopPropagation()}});F=function(){function e(){var d=[],f=t;if(!b)f=window.popupFormFields;for(var h=0;h<f.length;h++){var i=f[h],
j=c(p,"popupFormField_"+h),m="",l=j.querySelectorAll("select");l.length==0&&(l=j.querySelectorAll("textarea"),l.length==0&&(l=j.querySelectorAll("input")));if(l.length==1)m=l[0].value||"";else if(l.length>1){for(var m=[],n=0;n<l.length;n++)if(j=l[n],j.checked&&(m.push(j.value),j.type=="radio"))break;m=m.join(",")}if(i.required&&!m){Mugeda.messageBox((i.description||"item")+" required");l[0].focus();return}if(m)switch(i.type){case "phone":if(!/^\d+$/.test(m)){Mugeda.messageBox((i.description||"Phone number")+
" required");l[0].focus();return}break;case "email":if(!/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(m)){Mugeda.messageBox((i.description||"Email")+" required");l[0].focus();return}}a.openTarget==="default"?d.push(encodeURIComponent(i.description+"("+i.id+")")+"="+encodeURIComponent(m||"")):d.push(encodeURIComponent(i.id)+"="+encodeURIComponent(m||""))}if("popupFormIframe"==H)G("actionButton").value=a.pendingName;d=d.join("&");f=a.url+"?"+d;a.loadFinished=function(){if("popupFormIframe"==
H&&a.submitName)G("actionButton").value=a.submitName;g(p);self.popupFormDiv=null};if(a.openTarget=="customizable"){var k={callback:function(b){a.msg?Mugeda.messageBox(a.msg,"alert",function(){window.open(b,"_self")}):window.open(b,"_self")},cancel:false};window.MugedaCard&&MugedaCard.finalizeCustomParameters&&MugedaCard.finalizeCustomParameters(d,k);a.loadFinished()}else if(a.openTarget=="default"||a.openTarget=="page"||a.openTarget=="frame"||a.openTarget=="callback"){f=0;k=_mrmcp.creative_id||"";
_mrmcp.previewMode&&(f=3);if(k==""&&Mugeda&&Mugeda.data&&Mugeda.data.crid)k=Mugeda.data.crid;if(k==""&&/\/edit\/(\w+)\&?/.test(top.location.href))k=RegExp.$1,k.length<16?parent&&parent.crid?(k=parent.crid,f=2):f=1:f=2;else if(k==""&&/id=(\w+)\&?/.test(window.location.search))f=3,k=RegExp.$1;k||console.warn("\u6ca1\u6709\u83b7\u53d6\u5230crid");h=function(a,b,c){var c=c||"post",d=document.createElement("form"),e=document.createElement("iframe");d.setAttribute("method",c);d.setAttribute("action",a);
a="__iframe"+Math.random()*1E4;e.setAttribute("id",a);e.setAttribute("name",a);d.setAttribute("target",a);e.style.width=0;e.style.height=0;e.style.display="none";e.addEventListener("load",function(){});a=0;for(c=b.length;a<c;a++){var f=b[a].split("="),g=f[0],f=f[1],h=document.createElement("input");h.setAttribute("type","hidden");h.setAttribute("name",g);h.setAttribute("value",f);d.appendChild(h)}document.body.appendChild(d);document.body.appendChild(e);d.submit()};k&&/^[a-zA-Z0-9\-\_\.]+\.(mugeda|mgd5|h5mc|h5mgd|imugeda|mgdh5|hubpd)\.com$/.test(window.location.hostname)?
(i=window.Mugine.Utils.Browser.getWeixinServerHost()+"/server/cards.php/saveform",/_mrcmc=(.*?)(\&|$|\#)/.test(location.search)&&(d+="&_mrcmc="+RegExp.$1),/_mrcsc=(.*?)(\&|$|\#)/.test(location.search)&&(d+="&_mrcsc="+RegExp.$1),d+="&_msuid="+getMsuid(),d+="&user_id="+getOwnerid(),getUrlParam("is_course")&&(d+="&user_ref_id="+getMsuid(),d+="&course_id="+getUrlParam("course_id"),d+="&class_id="+getUrlParam("class_id"),d+="&section_id="+getUrlParam("section_id"),d+="&is_course="+getUrlParam("is_course")),
getUrlParam("is_exam")&&(d+="&exam_id="+getUrlParam("exam_id"),d+="&subject_id="+getUrlParam("subject_id"),d+="&is_exam="+getUrlParam("is_exam")),getUrlParam("is_course_exam")&&(d+="&subject_id="+getUrlParam("subject_id"),d+="&course_id="+getUrlParam("course_id"),d+="&class_id="+getUrlParam("class_id"),d+="&is_course_exam="+getUrlParam("is_course_exam")),h(i,(d+"&crid="+k+"&mode="+f).split("&")),a.msg&&Mugeda.messageBox(a.msg)):k&&(i=window.Mugine.Utils.Browser.getWeixinServerHost()+"/server/cards.php/saveform",
h(i,(d+"&crid="+k+"&mode="+f).split("&")),a.msg&&Mugeda.messageBox(a.msg));a.openTarget=="callback"?a.callback&&window[a.callback]?(k={callback:function(){a.msg&&Mugeda.messageBox(a.msg)},cancel:false},window[a.callback](d,k),MugedaTracker.fireEvent({category:"interaction",action:"form",label:"",value:a.id?parseInt(a.id,36):0}),k.cancel!==true&&k.callback()):console.log("No callback function found. Skipping..."):a.openTarget=="frame"?a.callback&&a.callback():a.openTarget=="page"&&a.callback&&a.callback();
a.loadFinished()}else try{if(a.url.indexOf("weika.mugeda.com/server/cards.php")!=-1){k=_mrmcp.creative_id||"";if(k==""&&Mugeda&&Mugeda.data&&Mugeda.data.crid)k=Mugeda.data.crid;else if(k==""&&parent&&parent.crid)k=parent.crid;else if(k==""&&/\/edit\/(\w+)\&?/.test(top.location.href))k=RegExp.$1;else if(k==""&&/id=(\w+)\&?/.test(window.location.search))k=RegExp.$1;f=f+"&crid="+k}window.open(f,H);G("popupFormIframe").onload=function(){a.loadFinished();MugedaTracker.fireEvent({category:"interaction",
action:"form",label:"",value:a.id?parseInt(a.id,36):0});a.msg&&Mugeda.messageBox(a.msg)}}catch(q){a.loadFinished(),Mugeda.messageBox("Form submission failed. Please try again. ")}}p.querySelector("#popupFormIframe").onload=null;for(m in i){var d=document.getElementById(i[m]);d&&(d.type=="checkbox"||d.type=="radio"?f(m,d.checked):f(m,d.value))}w<3?e():setTimeout(e,200);return false}}p.style.display="";p.form.innerHTML=a.html;if(a.id)p.form.id=a.id;var K=isMobile()?"touchstart":"click";p.form.querySelector("input[id=actionButton]").addEventListener(K,
F,false);p.style.display="";p.style.visibility="hidden";setTimeout(function(){n("mugedaFormInitialized",{form:p.form});p.style.visibility="visible"},200);setTimeout(function(){c(p,"popupFormCancel").addEventListener(K,function(){g(p);self.popupFormDiv=null},false)},500);C=p.querySelectorAll(".popupFormInput");for(k=0;k<C.length;k++)F=C[k],F.onfocus=onInputFocus,F.onblur=onInputBlur;var A;a.target?A=a.target.getBoundingClientRect():(C=Mugeda.getMugedaObject?Mugeda.getMugedaObject():null)&&a.isCss?
(j=C.adaption,A={left:Math.max(0,(window.Mugine?1:-1)*j.marginLeft),top:window.Mugine?0:Math.max(0,(window.Mugine?1:-1)*j.marginTop),width:Math.min(j.width,C.width),height:Math.min(j.height,C.height)}):A={left:0,top:0,width:j,height:h};document.body.style.overflowY="auto";if(e()){if(p.style.marginLeft=Math.max(2,A.left+document.documentElement.scrollLeft+(A.width-p.offsetWidth)/2)+"px",p.style.marginTop=Math.max(2,A.top+document.documentElement.scrollTop+(A.height-p.offsetHeight)/2)+"px",p.style.marginBottom=
"32px",p.offsetHeight+32>document.documentElement.scrollHeight&&(p.style.marginTop=parseInt(window.getComputedStyle?getComputedStyle(p).marginTop:p.currentStyle.marginTop)+32+"px",isMobile()))document.body.style.height=p.offsetHeight+64+"px"}else if(p.style.position="relative",p.style.left=A.left+"px",p.style.top=A.top+"px",Math.max(2,A.top+(A.height-p.offsetHeight)/2),Math.max(2,A.left+(A.width-p.offsetWidth)/2),!b){var J=p.querySelector("form");J.style.bottom="-9999px";p.style.overflow="hidden";
setTimeout(function(){p.style.background="rgba(0,0,0,0)";p.style.width=A.width+"px";p.style.height="100%";J.style.webkitTransition="none";J.style.bottom=-J.offsetHeight+"px";setTimeout(function(){J.style.webkitTransition="all 500ms";J.style.bottom="0px";J.style.overflowY="auto";!b&&(p.style.background="rgba(0,0,0,0.3)")},1)},1)}}}},getPopupFormHeight:function(a){for(var b=a.items,c=0,d=0,f=b.length;d<f;d++){var e=b[d];switch(e.type){case "input":case "phone":case "email":c+=44;break;case "textarea":c+=
64;break;case "radio":c+=48;break;case "checkbox":e=e.value.split("\n").length;c+=32*e+8;break;case "select":c+=36;break;default:c+=44}}a.title&&(c+=60);c+=8;c+=50;c+=16;return c},processAction:function(a,b,c,d){var f=true;if(a.type=="pause")this.pause(a.param);else if(a.type=="play")this.resume(1);else if(a.type=="next")this.next();else if(a.type=="previous")this.previous();else if(a.type=="nextPage")this.nextPage();else if(a.type=="prevPage")this.prevPage();else if(a.type=="disablePage")this.disablePage();
else if(a.type=="disablePageForward")this.disablePageForward();else if(a.type=="disablePageAfter")this.disablePageAfter();else if(a.type=="enablePage")this.enablePage();else if(a.type=="enablePageForward")this.enablePageForward();else if(a.type=="enablePageAfter")this.enablePageAfter();else if(a.type=="gotoPage"){var e=a.param&&a.param.page_number?a.param.page_number:a.param,b=typeof e=="string"?e.split(";"):[];b.length>1&&(e=b[Math.floor(Math.random()*b.length)]);e=parseInt(e);this.gotoPage(e)}else if(a.type==
"callback")this.callback(a.object,a.param);else if(a.type=="map")this.map(a.param);else if(a.type=="gotoAndPlay")e=a.param&&a.param.frame_number?a.param.frame_number:a.param,b=typeof e=="string"?e.split(";"):[],b.length>1&&(e=b[Math.floor(Math.random()*b.length)]),e=parseInt(e),isNaN(e)&&(e=a.param&&a.param.frame_name?a.param.frame_name:"",e=Mugeda.mapFrameNameId[e],e=parseInt(e)+1),this.gotoAndPlay(e);else if(a.type=="gotoAndPause"||a.type=="gotoAndStop")e=a.param&&a.param.frame_number?a.param.frame_number:
a.param,b=typeof e=="string"?e.split(";"):[],b.length>1&&(e=b[Math.floor(Math.random()*b.length)]),e=parseInt(e),isNaN(e)&&(e=a.param&&a.param.frame_name?a.param.frame_name:"",e=Mugeda.mapFrameNameId[e],e=parseInt(e)+1),this.gotoAndPause(e);else if(a.type=="call")MugedaMraid.makePhoneCall(a.param);else if(a.type=="sms")MugedaMraid.sendShortMessage(a.param);else if(a.type=="email")MugedaMraid.sendEmail(a.param);else if(a.type=="video")a.param.event=b,MugedaMraid.playVideo(a.param);else if(a.type==
"stopVideo")MugedaMraid.stopVideo(a.param);else if(a.type=="audio"){a.param.event=b;f=a.restart;if(window.Mugeda&&Mugeda.getMugedaObject){var g=Mugeda.getMugedaObject(),e=Math.floor(g.scene.currentId);a.unit&&a.unit.frameStart==e&&(f=true)}f=MugedaMraid.playAudio(a.param,f)}else if(a.type=="picture")MugedaMraid.savePicture(a.param);else if(a.type=="calendar")MugedaMraid.addCalendarEvent(a.param);else if(a.type=="expand")MugedaMraid.expand(a.param.url,0,a.param);else if(a.type=="resize")MugedaMraid.expand("",
1,a.param);else if(a.type=="stopAudio")Mugeda.stopAudio&&Mugeda.stopAudio(a.param);else if(a.type=="stopAllAudio")Mugeda.stopAudioAll&&Mugeda.stopAudioAll();else if(a.type=="submitForm"||a.type=="submitDefaultQuestion"||a.type==="submitDynamicQuestion"){var j=a.param,g=Mugeda.getMugedaObject?Mugeda.getMugedaObject():null,b=j.submit_object,h=(j.submit_target||0)==0?window.Mugine.Utils.Browser.getWeixinServerHost()+"/server/cards.php/saveform":j.submit_url,i="",n=0;if(_mrmcp.creative_id)i=_mrmcp.creative_id,
_mrmcp.previewMode&&(n=3);else if(Mugeda&&Mugeda.data&&Mugeda.data.crid)i=Mugeda.data.crid,n=3;if(i==""&&/\/edit\/(\w+)\&?/.test(top.location.href))j=RegExp.$1,j.length<16?parent&&parent.crid?(i=parent.crid,n=2):(i=j,n=1):(n=2,i=j);else if(i==""&&/id=(\w+)\&?/.test(window.location.search))n=3,i=RegExp.$1;if(a.type=="submitDefaultQuestion"||a.type==="submitDynamicQuestion")b=a.object.id||a.object._id;if(i&&b){for(var j=typeof b==="string"?b.split(","):Object.values(b),t=0,n="crid="+i+"&mode="+n,l=
{},k=[],x=false,w=false,i=0;i<j.length;i++){var q=j[i]||"",v=q.split("_"),o;if(typeof b==="object")var y=Object.keys(b)[i];if(v&&v.length>1){var m=g.scene.getObjectByName(v[0]);m&&(o=m.scene.getObjectByName(v[1]))}else o=a.type=="submitDefaultQuestion"||a.type==="submitDynamicQuestion"?g.scene.getObjectById(q,"guid"):g.scene.getObjectByName(q);v=function(a){try{var b=JSON.parse(localStorage.getItem("mugedaFormSubmitData"))}catch(c){b=[]}b=b.filter(function(b){return b.id!==a});try{localStorage.setItem("mugedaFormSubmitData",
JSON.stringify(b))}catch(d){console.log("\u8bb0\u5f55\u63d0\u4ea4\u8bb0\u5f55\u5931\u8d25")}};if(o)if(a.type=="submitDefaultQuestion"){if(g.aniData.metadata.question&&g.aniData.metadata.question.checkedNames){var z=o.displayObject.getSubmitQuestion(g.aniData.metadata.question.checkedNames,g.aniData.metadata.question.allScore);Object.keys(z).forEach(function(a){l[a]=z[a]});t++;w=x=true}}else if(o.data.type===2041){if(e=o.data.param.name){var m=o.data.param.required,r=o.dom.querySelector("input:checked");
if(m===1&&!r){Mugeda.messageBox("\u8bf7\u9009\u62e9\u3010"+e+"\u3011\uff0c\u8be5\u9879\u4e0d\u80fd\u4e3a\u7a7a\u3002");v(a.id);return}else l[e]=r?r.value:"",t++}}else if(o.data.type===2038){if(e=o.data.param.name)if(m=o.data.param.required,r=document.querySelectorAll('input[name="'+e+'"]:checked'),m===1&&!r.length){Mugeda.messageBox("\u8bf7\u9009\u62e9\u3010"+e+"\u3011\uff0c\u8be5\u9879\u4e0d\u80fd\u4e3a\u7a7a\u3002");v(a.id);return}else{for(var v=[],m=0,u=r.length;m<u;m++)v.push(r[m].value);l[e]=
v.length?v.join(","):"";t++}}else if(o.data.type===2039)if(m=o.data.param.required,r=unescape(o.data.param.textContent),u=o.dom.querySelector("option:checked"),m===1&&u&&u.innerText===r){Mugeda.messageBox("\u8bf7\u9009\u62e9\u3010"+(o.data.param.name||"\u4e0b\u62c9\u5217\u8868")+"\u3011\uff0c\u8be5\u9879\u4e0d\u80fd\u4e3a\u7a7a\u3002");v(a.id);return}else q=q.replace(/#/g,"_"),n+=u?"&"+q+"="+(u.value!==r?u.value:""):"&"+q+"=",t++;else if(o.data.type===2080||o.data.type===802083||o.data.type===2054){if(z=
o.getSubmitData(q),Object.keys(z).forEach(function(a){l[a]=z[a]}),t++,x=true,o.data.type===2054)var w=true,I=o.dom}else if(o.data.type===2005||o.data.type===2003||o.data.type===2004||o.data.type===2006){if(v=o.src){var B=new URL(v,window.location.origin);if(B.protocol==="data:"){var D=B.href;(function(){var a=y!==void 0?y:q,b=MugedaHelper.uploadImage({type:"base64",imgData:D}).then(function(b){return{name:a,value:encodeURIComponent(b.info)}});k.push(b);t++})()}else(function(){var a=y!==void 0?y:q,
b=MugedaHelper.uploadImage({type:"url",url:B.href}).then(function(b){return{name:a,value:encodeURIComponent(b.info)}});k.push(b);t++})()}}else if(o.data.type===2020)o.audio&&function(){var a=y!==void 0?y:q,b=MugedaHelper.uploadImage({type:"url",url:o.audio.src}).then(function(b){return{name:a,value:encodeURIComponent(b.info)}});k.push(b);t++}();else{r=o?o.text||"":"";r.indexOf("#")&&(r=r.replace(/\#/g,""));var u=o.data.param.inputType,p={tel:"^[1][3,4,5,6,7,8,9][0-9]{9}$",email:'^(([^<>()\\[\\]\\\\.,;:\\s@"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@"]+)*)|(".+"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$',
date:"",time:"",number:"^\\d+$",idCard:"^(^[1-9]\\d{7}((0\\d)|(1[0-2]))(([0|1|2]\\d)|3[0-1])\\d{3}$)|(^[1-9]\\d{5}[1-9]\\d{3}((0\\d)|(1[0-2]))(([0|1|2]\\d)|3[0-1])((\\d{4})|\\d{3}[Xx])$)$"},m=o.data.param.required;if(m===1&&!r.length){Mugeda.messageBox(o.data.param.errContent||"\u8bf7\u9009\u62e9\u3010"+o.data.param.name+"\u3011\uff0c\u8be5\u9879\u4e0d\u80fd\u4e3a\u7a7a\u3002");v(a.id);return}else if(r.length)if(u=="regExp"){if(m=o.data.param.inputRegExp)try{var H=RegExp(m).test(r);if(!H){o.data.param.textContentError?
Mugeda.messageBox(o.data.param.textContentError):Mugeda.messageBox("\u3010"+o.data.param.name+"\u3011\u7684\u5185\u5bb9\uff08"+r+"\uff09\u7684\u6b63\u5219\u6821\u9a8c\u4e0d\u901a\u8fc7\u3002\u8bf7\u68c0\u67e5\u540e\u91cd\u8bd5\u3002");v(a.id);return}}catch(F){Mugeda.messageBox("\u6b63\u5219\u6821\u9a8c\u89c4\u5219\u6709\u8bef\u3002\u8bf7\u68c0\u67e5\u540e\u91cd\u8bd5\u3002");return}}else if(m=p[u])if(H=RegExp(m).test(r),!H){o.data.param.textContentError?Mugeda.messageBox(o.data.param.textContentError):
Mugeda.messageBox("\u3010"+o.data.param.name+"\u3011\u7684\u5185\u5bb9\uff08"+r+"\uff09\u7684\u6b63\u5219\u6821\u9a8c\u4e0d\u901a\u8fc7\u3002\u8bf7\u68c0\u67e5\u540e\u91cd\u8bd5\u3002");v(a.id);return}if(q||y)q=(y!==void 0?y:q).replace(/#/g,"_"),n+="&"+q+"="+r,t++}}if(t==0)return;h+="?"+n;var C=null;if(x){b=new FormData;for(e in l)b.set(e,l[e]);C=b}else if(Object.keys(l).length>0)for(e in l)e.indexOf("#")?(b=l[e],e=e.replace(/#/g,"_"),h+="&"+e+"="+b):h+="&"+e+"="+l[e];if(a.extraData)for(var K in a.extraData)h+=
"&"+K+"="+a.extraData[K];/_mrcmc=(.*?)(\&|$|\#)/.test(location.search)&&(h+="&_mrcmc="+RegExp.$1);/_mrcsc=(.*?)(\&|$|\#)/.test(location.search)&&(h+="&_mrcsc="+RegExp.$1);/_msuid=[^&]+/.test(h)||(h+="&_msuid="+getMsuid());/user_id=[^&]+/.test(h)||(h+="&user_id="+getOwnerid());getUrlParam("is_course")&&(h+="&msuid="+getUrlParam("msuid"),h+="&course_id="+getUrlParam("course_id"),h+="&class_id="+getUrlParam("class_id"),h+="&section_id="+getUrlParam("section_id"),h+="&chapter_id="+getUrlParam("chapter_id"),
h+="&is_course="+getUrlParam("is_course"));getUrlParam("is_exam")&&(h+="&exam_id="+getUrlParam("exam_id"),h+="&subject_id="+getUrlParam("subject_id"),h+="&is_exam="+getUrlParam("is_exam"));getUrlParam("is_course_exam")&&(h+="&subject_id="+getUrlParam("subject_id"),h+="&course_id="+getUrlParam("course_id"),h+="&class_id="+getUrlParam("class_id"),h+="&is_course_exam="+getUrlParam("is_course_exam"));MugedaTools.message.show("\u6b63\u5728\u63d0\u4ea4");Promise.all(k)["catch"](function(a){MugedaTools.message.close();
d&&d({status:-1});Mugeda.messageBox(a)}).then(function(a){a.forEach(function(a){h+="&"+a.name.replace(/#/g,"_")+"="+a.value});a={url:h,type:"jsonp",type:"fetch",mode:"iframe",jsonp_callback:"form_callback",success:function(a){MugedaTools.message.close();w&&MugedaTools.message.showTikuEnd(l,I);d&&d(a)},error:function(a){MugedaTools.message.close();d&&d({status:a.status})}};if(x)a.type="fetch",a.method="POST",a.data=C,delete a.mode,delete a.jsonp_callback;ajaxHelper(a)})}}e="actoin_type="+a.type+"&refid="+
(new Date).getTime();for(item in a.param)e+="&"+item+"="+a.param[item];f&&c&&typeof a.param!=="undefined"&&a.param.event_name&&MugedaTracker.fireEvent({category:"interaction",action:a.param.event_name,label:e,value:0})},processCloseButton:function(a,b){_mrmcp=typeof _mrmcp=="undefined"?{}:_mrmcp;var c=b,d=null;if(!c)try{window!=window.parent?(c=window.parent.document,d=window.frameElement):c=document}catch(f){c=document}if(c){var e=null;try{e=window.parent.document,e.getElementById("mugeda_expanded")||
e.createElement("div")}catch(g){return}var j=a||_mrmcp.display_mode,h=MugedaMraid.mraidReadyStatus==1?mraid.getPlacementType():"default",i=c.getElementById("mugeda_close_button");if(!i)i=c.createElement("img"),i.id="mugeda_close_button",i.style.cursor="pointer",i.style.zIndex=99999,i.style.display="block",i.style.position="fixed",i.style.right="0",i.style.top="0",i.addEventListener("click",function(){if(MugedaMraid.mraidReadyStatus!=1){c.body.removeChild(i);j=="interstitial"&&d&&d.parentNode.removeChild(d);
var a=c.getElementById("mugeda_expanded");a&&c.body.removeChild(a)}}),c.body.appendChild(i);if(h=="interstitial"||j=="auto"||j=="resize"||j=="expand"||j=="interstitial")i.src=close_img_url,i.onerror=function(){i.style.display="none"},i.onload=function(){i.style.display=h=="interstitial"||j!="auto"?"block":"none"}}},setupMobileActionCallback:function(a){MugedaBehavior.actionCallback=a},setupMobileActions:function(a,b,c){function d(a){var c=navigator.userAgent.toLowerCase().indexOf("android")>-1,d=
c?15:20,e=c?5:10,n=function(a,g,k,l){if(Math.sqrt(a*a+g*g+k*k)>=(l?d:e)){a=(new Date).getTime();g=a-(MugedaBehavior.lastHitTime||0);if(!MugedaBehavior.lastHitTime||g>200)MugedaBehavior.shakeNum++,MugedaBehavior.lastHitTime=a;else if(g>1E3)MugedaBehavior.shakeNum=0;if(MugedaBehavior.shakeNum>=(c?1:2)){for(var n in MugedaBehavior.shakeHash){a=MugedaBehavior.shakeHash[n];for(g=0;g<a.length;g++)info=a[g],k=info.object,k=k.displayObject?k.displayObject.realVisible:true,info.callback&&k&&(MugedaBehavior.processAction(info.behavior,
info.behavior.event,true),info.callback())}MugedaBehavior.actionCallback&&MugedaBehavior.actionCallback(f,b.event);MugedaBehavior.shakeNum=0}}},t=0,l=0,k=0;if(a.acceleration===null||a.acceleration.x===void 0||a.acceleration.y===void 0||a.acceleration.z===void 0||a.acceleration.x===null||a.acceleration.y===null||a.acceleration.z===null){if(a.accelerationIncludingGravity)t=a.accelerationIncludingGravity.x,l=a.accelerationIncludingGravity.y,k=a.accelerationIncludingGravity.z,n(t,l,k,1)}else t=a.acceleration.x,
l=a.acceleration.y,k=a.acceleration.z,n(t,l,k,0)}var f=a.dataRef||a.aniData;isMobile();isMobile();isMobile();if(b.event=="shake"&&window.DeviceMotionEvent){if(!window.mugedaShakeHooked)MugedaBehavior.shakeNum=0,window.addEventListener("devicemotion",d,false),window.mugedaShakeHooked=true;var e=a.aniData?a.aniData.guid:null;e&&(MugedaBehavior.shakeHash[e]||(MugedaBehavior.shakeHash[e]=[]),MugedaBehavior.shakeHash[e].push({object:a,callback:c,behavior:b}))}}};
MugedaTracker={fireEvent:function(a){if(window.location&&window.location.host&&(this.fireGAEvent(a.category,a.action,a.label,a.value,a.noninteraction),this.fireMUEvent(a.category,a.action,a.label,a.value),window.mugedaGetCustomTracker)){var b=window.mugedaGetCustomTracker();if(b){_mrmcp=typeof _mrmcp=="undefined"?{}:_mrmcp;var c=_mrmcp.custom_params,d=_mrmma_tags;c&&c.indexOf("%CUSTOMPARAM%")<0&&(d+="&"+c);b(d,a.category,a.action,a.label,a.value)}}},fireGAEvent:function(a,b,c,d,f){typeof _gaq!="undefined"&&
(_gaq.push(["_trackEvent",a,b,c,d,f]),typeof _ga_mugeda_use_custom!="undefined"&&_gaq.push(["custom._trackEvent",a,b,c,d,f]))},fireMUEvent:function(a,b,c,d){typeof _mugeda_tracker!="undefined"&&_mugeda_tracker.trackEvent({action:b,category:a,label:c,value:d})}};
function mraidReady(){parseFloat(mraid.getVersion())-0.999>0?(MugedaMraid.mraidReadyStatus=1,_mrmcp=typeof _mrmcp=="undefined"?{}:_mrmcp,_mrmcp.display_mode&&(mraid.useCustomClose(true),MugedaBehavior.processCloseButton()),mraid.addEventListener("error",function(){}),mraid.addEventListener("stateChange",function(){var a=mraid.getState();MugedaMraid.setMraidState(a)}),mraid.addEventListener("sizeChange",function(){})):console.log("mraidReady is called, but with no correct version (>= 1.0) supported.")}
var mraidReadyTimeout,mraidTimeOut=100,mraidCounter=0;function readyListener(){typeof mraid==="undefined"?(mraidCounter++,mraidCounter<mraidTimeOut&&(mraidReadyTimeout=setTimeout(readyListener,100))):mraid.getState()==="loading"?mraid.addEventListener("ready",mraidReady):mraidReady()}readyListener();
try{var htmlDoc=document.getElementsByTagName("head").item(0),js=document.createElement("script"),jsPath=(_mrmcp.script_sub_path||".")+"/",s=jsPath+"mraid.js";js.setAttribute("type","text/javascript");js.setAttribute("src",s);htmlDoc.appendChild(js);js.onload=function(){};js.onerror=function(){}}catch(e$$30){alert(e$$30.toString())}
function genSessionId(a){for(var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),c=Number(+new Date).toString(36),d=0,f="",e=b.length;d<a;d++)f+=b[Math.floor(Math.random()*e)];return c+f.toLowerCase()}
Mugeda.playEmbeddedVideo=function(a){a=a.target.parentElement;a.style.display="none";for(var b=0;b<a.parentElement.children.length;b++)a.parentElement.children[b].setAttribute("contenteditable","false");var c=a.previousSibling;c.play();c.onclick=function(){c.controls=c.paused?false:true;c.paused?c.play():c.pause()};if(navigator.userAgent.match(/mqqbrowser.*tbs/i)){for(var d=null;;)if(a=a.parentElement,a.className.indexOf("mugeda_richText_content")>=0){d=a.parentElement;break}else if(a==document.body)break;
var a=d.scrollTop,f=document.createElement("div");f.className="qbrowser_workaround";f.style.position="absolute";f.style.width="1px";f.style.height="1px";f.style.left=0;f.style.top=a+"px";d.appendChild(f);if(d)d.onscroll=function(){f.style.top=d.scrollTop+"px"}}};
Mugeda.DataStats={onEventCallback:null,newsetData:{},init:function(a){var b=this;b.isPreview=location.pathname==="/client/preview_css3.html"&&/mugeda.com$/.test(location.host);if(!b.isPreview&&(b.viewId=function(){var a=Math.random().toString().substr(2,4)+""+(new Date-new Date("2012/1/1"));return Number(a).toString(36)}(),b.crid=_mrmcp.creative_id||Mugeda.data.crid||null,b.currentPageId=a.indexPageId,b.currentPageName=a.indexPageName,b.pageNum=a.indexPageNum,b.lockTime=false,b["static"]=false,b.staticSecond=
0,b.msuid=getMsuid(),document.addEventListener("visibilitychange",function(){document.visibilityState==="hidden"&&b.logData()}),b.crid&&!b.isStart)){b.isStart=true;if(!b.videoHash)b.videoHash={};b.statData={crid:b.crid,viewId:b.viewId,pages:[],pageNum:b.pageNum};b.entry({type:"loadTime",indexPageId:a.indexPageId,indexPageName:a.indexPageName,totalPages:a.totalPages});b.bindTimer()}},logData:function(){var a;try{a=window.localStorage}catch(b){a=null}if(a){for(var c=[],d=0;d<a.length;d++){var f=a.key(d);
f.indexOf("leaveData_")>-1&&c.push(f)}if(c.length)for(d=0;d<c.length;d++){var e=c[d];if(f=localStorage.getItem(e))f=JSON.parse(f),f.isLeave=true,this.uploadData(f,null,null,function(){a.removeItem(e)},true)}}},bindTimer:function(){var a=this,b=(new Date).getTime(),c=0;a.second=1;var d=function(){c++;var f=1E3-((new Date).getTime()-(b+c*1E3));f<0&&(f=0);setTimeout(d,f);if(!a.lockTime)f=a.getCurrentPage(),a["static"]=a.staticSecond>60?true:false,a.second>=10&&!a["static"]?(a.legalTime(f.stayTime)&&
(f.stayTime+=1E3),f={crid:a.crid,viewId:a.viewId,pages:[{id:a.currentPageId,name:a.currentPageName,stayTime:f.stayTime}]},a.second=1,a.uploadData(f)):(a.legalTime(f.stayTime)&&(f.stayTime+=1E3),a.updateNewsetData({pages:[f],crid:a.crid,viewId:a.viewId}),a.second++),a.staticSecond++};setTimeout(d,1E3)},getCurrentPage:function(){for(var a,b=this.statData.pages,c=0;c<b.length;c++)b[c].id==this.currentPageId&&(a=b[c]);return a},entry:function(a){a=a||{};if(!this.isPreview){if(a){var b=a.type;this.staticSecond=
0;switch(b){case "loadTime":this.loadTime(a);break;case "updatePageTime":this.updatePageTime(a);break;case "interActions":this.interActions(a);break;case "playVideo":this.playVideo(a);break;case "stopVideo":this.stopVideo(a)}}if(a.event&&this.onEventCallback)this.onEventCallback({event:a.event})}},legalTime:function(a){return a<0||a>864E5?false:true},loadTime:function(a){var b=(new Date).valueOf()-performance.timing.connectStart,c=a.indexPageId;this.legalTime(b)&&this.uploadData({crid:this.crid,viewId:this.viewId,
loadTime:b,totalPages:a.totalPages,pages:[{id:c,name:a.indexPageName,stayTime:0}]});this.statData.pages.push({id:c,name:a.indexPageName,stayTime:0})},updatePageTime:function(a){if(this.statData){var b=this.statData.pages;if(b.length){for(var c=false,d=0;d<b.length;d++)b[d].id==a.toId&&(c=true);c||b.push({name:a.toName,id:a.toId,stayTime:0})}else console.log("\u903b\u8f91\u9519\u8bef");c={crid:this.crid,viewId:this.viewId,pages:[],media:[]};for(d=0;d<b.length;d++)(b[d].id==a.fromId||b[d].id==a.toId)&&
c.pages.push(b[d]);this.currentPageId=a.toId;this.uploadData(c)}},interActions:function(a){if(this.statData){var b={crid:this.crid,viewId:this.viewId,pages:[],interactions:[],media:[]},c=this.getCurrentPage();c?(b.pages.push(c),b.interactions=a.data,this.uploadData(b)):console.log("\u903b\u8f91\u9519\u8bef,\u6ca1\u6709\u62ff\u5230\u5f53\u524d\u9875\u6570\u636e.")}},playVideo:function(a){var b=a.id,c=this.videoHash;if(!c)c=this.videoHash={};c[b]?c[b].isUpdate=true:c[b]={id:b,viewLength:0,belong:this.currentPageId,
isUpdate:true,video:a.target}},stopVideo:function(a){var a=a.id,b=this.videoHash;if(b[a]){var c=b[a].target||document.querySelector('[data-guid="'+a+'"] video');b[a].viewLength=Math.floor((c?c.currentTime:0)*1E3)}else console.log("\u903b\u8f91\u9519\u8bef,\u6ca1\u6709\u627e\u5230\u89c6\u9891.")},updateNewsetData:function(a){var b=this.newsetData,c=function(a,b,c){var d={};a[c].map(function(a){d[a.id]=a});for(var h=0;h<b[c].length;h++){var i=b[c][h],n=d[i.id];if(n){if(c=="media"&&n.viewLength!==void 0&&
i.viewLength!==void 0)n.viewLength=Math.max(i.viewLength,n.viewLength);if(n.stayTime!==void 0&&i.stayTime!==void 0)n.stayTime=Math.max(i.stayTime,n.stayTime);if(i.action=="submitForm")n.formCount=(n.formCount||0)+1}else if(a[c].push(i),d[i.id]=i,i.action=="submitForm")delete d[i.id].data,d[i.id].formCount=(d[i.id].formCount||0)+1}};b.reportTime=(new Date).getTime();b.mode="full";b.pageNum=this.pageNum;if(a.connectionType&&!b.connectionType)b.connectionType=a.connectionType;if(a.forward&&!b.forward)b.forward=
a.forward;if(a.crid&&!b.crid)b.crid=a.crid;if(a.msuid&&!b.msuid)b.msuid=a.msuid;if(a.viewId&&!b.viewId)b.viewId=a.viewId;if(a.loadTime&&!b.loadTime)b.loadTime=a.loadTime;if(a.profile)b.profile=a.profile;if(a.media&&a.media.length)b.media&&b.media.length?c(b,a,"media"):b.media=a.media;if(a.totalPages&&a.totalPages.length)b.totalPages&&b.totalPages.length?c(b,a,"totalPages"):b.totalPages=a.totalPages;if(a.pages&&a.pages.length)b.pages&&b.pages.length?c(b,a,"pages"):b.pages=a.pages;if(a.interactions&&
a.interactions.length)b.interactions&&a.interactions.length?c(b,a,"interactions"):b.interactions=a.interactions;if(getUrlParam("is_course"))b.user_ref_id=a.msuid,b.course_id=getUrlParam("course_id"),b.class_id=getUrlParam("class_id"),b.section_id=getUrlParam("section_id"),b.is_course=getUrlParam("is_course");try{localStorage.setItem("leaveData_"+this.crid,JSON.stringify(b))}catch(d){console.log(d)}return b},getQueryString:function(a){a=window.location.search.substr(1).match(RegExp("(^|&)"+a+"=([^&]*)(&|$)"));
return a!=null?decodeURIComponent(a[2]):null},getNetworkType:function(){try{var a=navigator.userAgent,b=a.match(/NetType\/\w+/)?a.match(/NetType\/\w+/)[0]:"NetType/other",b=b.toLowerCase().replace("nettype/",""),c;if(navigator.connection&&navigator.connection.type)return navigator.connection.type;switch(b){case "wifi":c="wifi";break;case "4g":c="4g";break;case "3g":c="3g";break;case "3gnet":c="3g";break;case "2g":c="2g";break;default:c="other"}return c}catch(d){return"other"}},uploadData:function(a,
b,c,d,f){f=f||false;if(window._mrmcp.publish_time){var e=this,g=JSON.parse(JSON.stringify(a));d&&d();e.lockTime=true;var j=_mrmcp.stat_host||"",d=j||"//"+e.crid+".stat.mugeda.com/stats/c.gif";!j&&location.protocol==="file:"&&(d="https:"+d);g.media&&g.media.length===0&&delete a.media;g.msuid=e.msuid;a={};if(e.getQueryString("avatar"))a.avatar=e.getQueryString("avatar");if(e.getQueryString("nickname"))a.nickname=e.getQueryString("nickname");if(e.getQueryString("openid"))a.openid=e.getQueryString("openid");
g.profile=a;g.connectionType=e.getNetworkType();if(getUrlParam("prev"))g.forward="msuid="+getUrlParam("prev")+"&time="+getUrlParam("time");if(!g.isLeave&&getUrlParam("is_course"))g.user_ref_id=g.msuid,g.course_id=getUrlParam("course_id"),g.class_id=getUrlParam("class_id"),g.section_id=getUrlParam("section_id"),g.is_course=getUrlParam("is_course");if(g.crid.length!=24)if(a=g.crid.split("/"),a.length)a.forEach(function(a){if(a.length==24)g.crid=a});else return;if(a=e.videoHash)for(key in a){var h=a[key].target||
document.querySelector('[data-guid="'+key+'"] video'),j=Math.floor(h?h.currentTime*1E3:a[key].viewLength||0),h=h?h.getAttribute("data-vname"):"";if(a[key].belong==e.currentPageId){if(!g.media)g.media=[];g.media.push({id:key,viewLength:j,type:"video",name:h})}}g.isLeave||(g=e.updateNewsetData(g));a=JSON.stringify(g);a=Base64.encode(encodeURIComponent(a));console.log(JSON.parse(decodeURIComponent(Base64.decode(a))));j="";g.viewId&&(j+="&vi="+g.viewId);g.reportTime&&(j+="&tm="+g.reportTime);g.mode&&
(j+="&md="+g.mode);g.crid&&(j+="&crid="+g.crid);d=d+"?random="+Math.random()+"&data="+a+j;delete g.isLeave;a=false;if(f)try{var i=navigator.sendBeacon(d),a=true;i?b&&b():c&&c();e.lockTime=false;e.second=1}catch(n){}if(!a)f=new Image,f.src=d,f.onload=function(){b&&b();e.lockTime=false},f.onerror=function(){c&&c();e.lockTime=false},e.second=1}else console.log("\u975e\u53d1\u5e03\u4f5c\u54c1, \u4e0d\u4e0a\u62a5\u7edf\u8ba1\u3002")}};
Mugeda.Analytics=function(a,b){var c=[],d=0,f=_mrmcp.impression_pixel?_mrmcp.impression_pixel.indexOf("%TRACKURL%")>=0?"":_mrmcp.impression_pixel:"";window._mrmcp=window._mrmcp||{};var e=_mrmcp.stat_host||"",a=a||e||f||"//"+_mrmcp.creative_id+".stat.mugeda.com/stats/c.gif",b=b||_mrmcp.eventUrl||a;this.setAccount=function(){};this.setCustomVar=function(a,b,d){a=a||0;c[a]&&delete c[a];c[a]={};c[a][b]=d||""};var g=function(){getCookie("clientId");for(var a=[],b=0;b<c.length;b++)for(var d in c[b])a[b]=
d+"="+encodeURIComponent(c[b][d]);return a.join("&")},j=function(){var a=location.pathname,b=/(?:\/animation\/edit)|(?:\/page\/edit)|(?:\/default\/preview\.html)|(?:\/client\/preview(?:_css3)?\.html)/;return!location.host||b.test(a)?false:true};this.trackPageview=function(b){if(j()){this.startTime=(new Date).getTime();var c=a,e=new Image,f=c.indexOf("?")!=-1?"&":"?",l=_mrmcp.title||window._mrmma_title,k=+new Date,x=window.location.host,w=(_mrmcp.width||window._mrmma_width||0)+"x"+(_mrmcp.height||
window._mrmma_height||0),q=window.location.href.slice(window.location.href.indexOf("/",8)),v=screen.width+"x"+screen.height,b=b||{};b.msv="0.1.0";b.msa="MU-A001";b.msh=x;b.mscs=w;b.msp=q;b.mssr=v;b.mssi=genSessionId(16);b.mscn=l;b.msct=k;b.crid=_mrmcp.creative_id||"";getUrlParam("prev")&&(b.forword="msuid="+getUrlParam("prev")+"&time="+getUrlParam("time"));for(var o in b)b.hasOwnProperty(o)&&(this.setCustomVar(d,o,b[o]),d++);var y=this;getMsuid(function(){y.setCustomVar(d++,"msuid",getMsuid());var a=
g();window.mugedaOutsideStorage&&(a="moss=1&"+a);e.src=c+f+("md=pv&mst=1&"+a)})}};this.trackEvent=function(a){if(j()){var c=new Image,d=b,e=d.indexOf("?")!=-1?"&":"?",f=g(),a=a||{},k=(new Date).getTime(),x=k-this.startTime,w=encodeURIComponent(a.action||"submit"),q=encodeURIComponent(a.categroy||"weika"),v=encodeURIComponent(a.label||""),a=parseInt(a.value)||0;c.src=d+e+f+"&mst=2&msts="+k+"&msetd="+x+"&msen="+w+"&msev="+a+"&msec="+q+"&msel="+v}}};
try{if(window._mrmcp&&window._mrmcp.publish_time)window._mugeda_tracker=new Mugeda.Analytics,_mugeda_tracker.trackPageview()}catch(e$$34){}
function createFontFaceStyle(a,b,c,d,f,e,g){if(!b)return f&&f(a,null),a;var g=g||{},j="cloudfont-"+b;c&&(j+="-"+c);var h=document.getElementById(j),e=Object.prototype.toString.call(d)==="[object Array]"&&typeof f==="function",i=function(a){return(a=RegExp("[?&]"+a+"=([^&#]*)").exec(window.location.href))?a[1]:0};a.toLowerCase()=="simhei"?a='"Microsoft YaHei", "\u5fae\u8f6f\u96c5\u9ed1", SimHei, sans-serif':c&&(a+="-"+c);if(h)if(e&&g.useBlob&&h.data)return f(a,h.data),a;else if(!g.useBlob)return e&&
(b=h.textContent.match(/src:url\((.*?)\)/),f(a,b?b[1]:null)),a;var g=(g=i("fontApiType"))?g:3,h=d||["eot","eot","woff","ttf","svg"],n=b.indexOf("?")>-1?"&":"?";window.bd_version||i("v");for(var i=[],t=d&&d.length,l=d=0,k=function(a,b){var d=document.querySelector(".cloudfont_"+c);d&&document.head.removeChild(d);var e=document.createElement("style"),f,g=function(a){e.id=j;e.className="cloudfont_"+c;a=document.createTextNode(a);e.type="text/css";e.data=b;e.appendChild(a);document.head.appendChild(e)};
if(b&&b.type!="text/html"){var h,i=new window.FileReader;i.readAsDataURL(b);i.onloadend=function(){h=i.result;f="@font-face {font-family:'"+a+"';\nsrc:url("+h+");}";g(f)}}else a.indexOf("cloud-")!=0&&(f="@font-face {font-family:'"+a+"';}",g(f))},x=function(b){ajaxHelper({url:b.split("?")[0],cache_ok:true,type:"data",method:"POST",formData:function(a){var b=new FormData;a.slice(a.indexOf("?")+1).split("&").forEach(function(a){a=a.split("=");a[0]==="content"&&(a[1]=decodeURI(a[1]));b.append(a[0],a[1])});
return b}(b),success:function(b){++l===t&&typeof f==="function"&&(k(a,b),f(a,b))},error:function(a){a.status==414&&Mugeda.messageBox(Lang.M_TextTooLong);if(--t===0)throw f(false),"request font failed";}})},w=0,q=h.length;w<q;w++){var v=b+n+"format="+h[w]+"&api_type="+g,o="url("+v+")";if(w>0){var y=h[w];h[w]==="eot"?y="embedded-opentype":h[w]==="ttf"&&(y="truetype");o+=" format('"+y+"')"}i.push(o);e&&(d++,x(v))}if(e&&d===0)throw"request type invalid";return e?null:a}
Mugeda.messageBox=function(a,b,c,d){var d=d||{},f=document.createElement("div");f.id="message_holder_"+(new Date).getTime();f.style.display="block";f.style.position="absolute";f.style.zIndex=2E5;var e=document.querySelector('[data-type="stage"]'),g=document.documentElement.clientWidth,j=document.documentElement.clientHeight,h=g>j;e.clientWidth>e.clientHeight!=g>j?(f.style.transformOrigin="center",f.style.webkitTransform="rotate(90deg)",f.style.transform="rotate(90deg)",f.style.width=j+"px",f.style.height=
g+"px",f.style.left=(g-j)/2+"px",f.style.top=(j-g)/2+"px"):(f.style.width="100%",f.style.height="100%",f.style.left=0,f.style.top=0);e=document.createElement("div");e.className="messageMask";e.style.display="block";e.style.position="absolute";e.style.left=0;e.style.top=0;e.style.width="100%";e.style.height="100%";e.style.backgroundColor="rgba(0,0,0,0.5)";f.appendChild(e);var b=b||"alert",i=document.createElement("div");i.className="messageInfo";i.style.display="block";i.style.position="absolute";
if(d.width)i.style.width=d.width+"px";i.innerHTML='<div class="messageBody">'+a+'</div><div align="center" class="messageConfirm '+b+'" onclick="onConfirmMessage();">'+(d.okText||"\u786e\u8ba4")+'</div><div align="center" class="messageCancel '+b+'" onclick="onCancelMessage();">'+(d.cancelText||"\u53d6\u6d88")+"</div>";f.appendChild(i);document.body.appendChild(f);f.querySelector(".messageConfirm").onclick=function(){document.body.removeChild(f);c&&c(true)};f.querySelector(".messageCancel").onclick=
function(){document.body.removeChild(f);c&&c(false)};f.querySelector(".messageMask").onclick=function(){i.className="messageInfo blinking";setTimeout(function(){i.className="messageInfo"},800)};a=document.getElementById("mugeda_message_styles");if(!a)a=document.createElement("style"),a.type="text/css",a.id="mugeda_message_styles",a.innerHTML=".messageBody { padding:32px; background-color: #fff; border-top-left-radius: 4px; border-top-right-radius: 4px; }.messageInfo { max-width: 512px; min-width: 256px; margin-left:50%; transform: translate(-50%, -50%); margin-top: "+
(h?j/2:g/2)+"px; font-size:14px; border: 4px solid rgba(0,0,0,0); border-radius:8px; line-height: 20px; }.messageConfirm, .messageCancel { width: 50%; display: inline-block; height: 48px; line-height: 48px; color: #fff; cursor: pointer; }.messageConfirm.alert { width: 100%; }.messageCancel.alert { display: none;}.messageCancel:active, .messageConfirm:active {-webkit-filter: brightness(115%);}.messageConfirm { background-color: #F36523; border-bottom-left-radius: 4px;}.messageInfo.blinking{ -webkit-animation: blinking 200ms infinite step-end; animation: blinking 200ms infinite step-end; }@-webkit-keyframes blinking {0% {border-color: rgba(255,0,0,0);} 50% {border-color: rgba(255,0,0,0.6);}}@keyframes blinking {0% { border-color: rgba(255,0,0,0);} 50% { border-color: rgba(255,0,0,0.6);}}.messageCancel { background-color: #999; border-bottom-right-radius: 4px;}",
document.body.appendChild(a)};
Mugeda.InstantMessage=function(){var a;return{show:function(b){var c=document.createElement("div"),d=c.appendChild(document.createElement("div")),f=d.appendChild(document.createElement("div")),e=d.appendChild(document.createElement("div"));c.style.cssText="position:fixed;left:0;right:0;top:0;bottom:0;text-align:center;line-height:"+(document.body.clientHeight||document.documentElement.clientHeight)+"px";d.style.cssText='padding-top:10px; line-height:30px;display:inline-block;padding:8px; min-width: 80px; background-color:rgba(0,0,0,0.6);border-radius:4px;"';d.align=
"center";f.style.cssText="width: 24px; height: 24px; display: block; border-radius: 50%; border-left: 2px solid #F36523; border-top: 2px solid #F36523; border-right: 2px solid white; border-bottom: 2px solid white; margin: 16px;";e.style.cssText='text-align:center;color:#fff;font:normal 12px "microsoft yahei";';e.innerHTML=b;a=document.body.appendChild(c);b=StyleSheetManager.insertKeyframes("from {"+Browser.prefix.css+"transform:rotate( 0deg ) }to {"+Browser.prefix.css+"transform:rotate( 360deg ) }");
f.style.cssText+=Browser.prefix.css+"animation:"+b+" 1200ms linear infinite;"},close:function(){a&&(a.parentNode.removeChild(a),a=null)}}}();
